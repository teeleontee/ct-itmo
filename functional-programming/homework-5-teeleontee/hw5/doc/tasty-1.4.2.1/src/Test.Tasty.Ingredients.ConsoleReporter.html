<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_2PomoessivgJGXWkeqCncT"></span><span class="hs-comment">-- vim:fdm=marker</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns, ImplicitParams, MultiParamTypeClasses, DeriveDataTypeable, FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | Console reporter ingredient</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Tasty.Ingredients.ConsoleReporter</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporter"><span class="hs-identifier">consoleTestReporter</span></a></span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterWithHook"><span class="hs-identifier">consoleTestReporterWithHook</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier">Quiet</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier">HideSuccesses</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier">AnsiTricks</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Internals</span></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-comment">-- | The following functions and datatypes are internals that are exposed to</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-comment">-- simplify the task of rolling your own custom console reporter UI.</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Output colouring</span></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier">UseColor</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#useColor"><span class="hs-identifier">useColor</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Test failure statistics</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier">Statistics</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeStatistics"><span class="hs-identifier">computeStatistics</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatistics"><span class="hs-identifier">printStatistics</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatisticsNoTime"><span class="hs-identifier">printStatisticsNoTime</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Outputting results</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier">TestOutput</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#buildTestOutput"><span class="hs-identifier">buildTestOutput</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier">foldTestOutput</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#withConsoleFormat"><span class="hs-identifier">withConsoleFormat</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">EQ</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">reader</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.STM</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html"><span class="hs-identifier">Test.Tasty.Core</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Providers.ConsoleFormat.html"><span class="hs-identifier">Test.Tasty.Providers.ConsoleFormat</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html"><span class="hs-identifier">Test.Tasty.Run</span></a></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.html"><span class="hs-identifier">Test.Tasty.Ingredients</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ListTests.html"><span class="hs-identifier">Test.Tasty.Ingredients.ListTests</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html"><span class="hs-identifier">Test.Tasty.Options</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Options.Core.html"><span class="hs-identifier">Test.Tasty.Options.Core</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Patterns.html"><span class="hs-identifier">Test.Tasty.Patterns</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Patterns.Printer.html"><span class="hs-identifier">Test.Tasty.Patterns.Printer</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Patterns.Types.html"><span class="hs-identifier">Test.Tasty.Patterns.Types</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Runners.Reducers.html"><span class="hs-identifier">Test.Tasty.Runners.Reducers</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Tasty.Runners.Utils.html"><span class="hs-identifier">Test.Tasty.Runners.Utils</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.IntMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span class="hs-cpp">
#ifdef VERSION_wcwidth
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char.WCWidth</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">wcwidth</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isInfixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Any</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Sem</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Options.Applicative</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">action</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">str</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Success</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Failure</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.ANSI</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Monoid</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">foldMap</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-65"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- TestOutput base definitions</span><span>
</span><span id="line-67"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | 'TestOutput' is an intermediary between output formatting and output</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- printing. It lets us have several different printing modes (normal; print</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- failures only; quiet).</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- @since 0.12</span><span>
</span><span id="line-74"></span><span class="hs-keyword">data</span><span> </span><span id="TestOutput"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-var">TestOutput</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PrintTest"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintTest"><span class="hs-identifier hs-var">PrintTest</span></a></span></span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-comment">{- test name         -}</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">{- print test name   -}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-comment">{- print test result -}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-comment">-- ^ Name of a test, an action that prints the test name, and an action</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-comment">-- that renders the result of the action.</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PrintHeading"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintHeading"><span class="hs-identifier hs-var">PrintHeading</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- ^ Name of a test group, an action that prints the heading of a test</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-comment">-- group and the 'TestOutput' for that test group.</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Skip"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span></span><span> </span><span class="hs-comment">-- ^ Inactive test (e.g. not matching the current pattern)</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Seq"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Seq"><span class="hs-identifier hs-var">Seq</span></a></span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-comment">-- ^ Two sets of 'TestOuput' on the same level</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- The monoid laws should hold observationally w.r.t. the semantics defined</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- in this module</span><span>
</span><span id="line-89"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078350"><span id="local-6989586621679078352"><span class="annot"><span class="hs-identifier hs-type">Sem.Semigroup</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679078348"><span class="annot"><span class="annottext">&lt;&gt; :: TestOutput -&gt; TestOutput -&gt; TestOutput
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOutput -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Seq"><span class="hs-identifier hs-var">Seq</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078342"><span id="local-6989586621679078344"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679078340"><span class="annot"><span class="annottext">mempty :: TestOutput
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span>  </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">Sem.&lt;&gt;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#applyHook"><span class="hs-identifier hs-type">applyHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span>
</span><span id="line-98"></span><span id="applyHook"><span class="annot"><span class="annottext">applyHook :: ([TestName] -&gt; Result -&gt; IO Result) -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#applyHook"><span class="hs-identifier hs-var hs-var">applyHook</span></a></span></span><span> </span><span id="local-6989586621679078338"><span class="annot"><span class="annottext">[TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078338"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; TestOutput -&gt; TestOutput
</span><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679078337"><span class="annot"><span class="annottext">go :: [TestName] -&gt; TestOutput -&gt; TestOutput
</span><a href="#local-6989586621679078337"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679078336"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078336"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintTest"><span class="hs-identifier hs-type">PrintTest</span></a></span><span> </span><span id="local-6989586621679078335"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078335"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078334"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078334"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078333"><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078333"><span class="hs-identifier hs-var">printResult</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; (Result -&gt; IO ()) -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintTest"><span class="hs-identifier hs-var">PrintTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078335"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078334"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078333"><span class="hs-identifier hs-var">printResult</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; IO ()) -&gt; (Result -&gt; IO Result) -&gt; Result -&gt; IO ()
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078338"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078335"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; [TestName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078336"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679078331"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078331"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintHeading"><span class="hs-identifier hs-type">PrintHeading</span></a></span><span> </span><span id="local-6989586621679078330"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078330"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078329"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078329"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078328"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078328"><span class="hs-identifier hs-var">printBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintHeading"><span class="hs-identifier hs-var">PrintHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078330"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078329"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestName] -&gt; TestOutput -&gt; TestOutput
</span><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078330"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; [TestName]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078331"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078328"><span class="hs-identifier hs-var">printBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679078327"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078327"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span id="local-6989586621679078326"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078326"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679078325"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078325"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOutput -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Seq"><span class="hs-identifier hs-var">Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestName] -&gt; TestOutput -&gt; TestOutput
</span><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078327"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078326"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestName] -&gt; TestOutput -&gt; TestOutput
</span><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078327"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078325"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><a href="#local-6989586621679078337"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestOutput
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">type</span><span> </span><span id="Level"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Level"><span class="hs-identifier hs-var">Level</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Build the 'TestOutput' for a 'TestTree' and 'OptionSet'. The @colors@</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- ImplicitParam controls whether the output is colored.</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-113"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#buildTestOutput"><span class="hs-identifier hs-type">buildTestOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html#OptionSet"><span class="hs-identifier hs-type">OptionSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span>
</span><span id="line-114"></span><span id="buildTestOutput"><span class="annot"><span class="annottext">buildTestOutput :: OptionSet -&gt; TestTree -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#buildTestOutput"><span class="hs-identifier hs-var hs-var">buildTestOutput</span></a></span></span><span> </span><span id="local-6989586621679078323"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078323"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679078322"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078322"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- Do not retain the reference to the tree more than necessary</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">!</span><span id="local-6989586621679078321"><span class="annot"><span class="annottext">alignment :: Int
</span><a href="#local-6989586621679078321"><span class="hs-identifier hs-var hs-var">alignment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeAlignment"><span class="hs-identifier hs-var">computeAlignment</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078323"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078322"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679078513"><span class="annot"><a href="#local-6989586621679078319"><span class="hs-identifier hs-type">runSingleTest</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Core.html#IsTest"><span class="hs-identifier hs-type">IsTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html#OptionSet"><span class="hs-identifier hs-type">OptionSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078513"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679078319"><span class="annot"><span class="annottext">runSingleTest :: OptionSet -&gt; TestName -&gt; t -&gt; Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078319"><span class="hs-identifier hs-var hs-var">runSingleTest</span></a></span></span><span> </span><span id="local-6989586621679078318"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078318"><span class="hs-identifier hs-var">_opts</span></a></span></span><span> </span><span id="local-6989586621679078317"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078317"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078316"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679078316"><span class="hs-identifier hs-var">_test</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput)
-&gt; Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>      </span><span id="local-6989586621679078314"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reader Int Int
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-126"></span><span>        </span><span id="local-6989586621679078312"><span class="annot"><span class="annottext">printTestName :: IO ()
</span><a href="#local-6989586621679078312"><span class="hs-identifier hs-var hs-var">printTestName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>          </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName -&gt; TestName -&gt; IO ()
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%s%s: %s&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078317"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; TestName
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078321"><span class="hs-identifier hs-var">alignment</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indentSize"><span class="hs-identifier hs-var">indentSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#stringWidth"><span class="hs-identifier hs-var">stringWidth</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078317"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679078303"><span class="annot"><span class="annottext">printTestResult :: Result -&gt; IO ()
</span><a href="#local-6989586621679078303"><span class="hs-identifier hs-var hs-var">printTestResult</span></a></span></span><span> </span><span id="local-6989586621679078302"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>          </span><span id="local-6989586621679078301"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078301"><span class="hs-identifier hs-var">rDesc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO TestName
</span><a href="Test.Tasty.Runners.Utils.html#formatMessage"><span class="hs-identifier hs-var">formatMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO TestName) -&gt; TestName -&gt; IO TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><a href="Test.Tasty.Core.html#resultDescription"><span class="hs-identifier hs-var hs-var">resultDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-comment">-- use an appropriate printing function</span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-136"></span><span>            </span><span id="local-6989586621679078298"><span class="annot"><span class="annottext">printFn :: TestName -&gt; IO ()
</span><a href="#local-6989586621679078298"><span class="hs-identifier hs-var hs-var">printFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-137"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Outcome
</span><a href="Test.Tasty.Core.html#resultOutcome"><span class="hs-identifier hs-var hs-var">resultOutcome</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-138"></span><span>                </span><span class="annot"><span class="annottext">Outcome
</span><a href="Test.Tasty.Core.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span>
</span><span id="line-139"></span><span>                </span><span class="annot"><a href="Test.Tasty.Core.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span> </span><span class="annot"><span class="annottext">FailureReason
</span><a href="Test.Tasty.Core.html#TestDepFailed"><span class="hs-identifier hs-var">TestDepFailed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#skipped"><span class="hs-identifier hs-var">skipped</span></a></span><span>
</span><span id="line-140"></span><span>                </span><span class="annot"><span class="annottext">Outcome
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#fail"><span class="hs-identifier hs-var">fail</span></a></span><span>
</span><span id="line-141"></span><span>            </span><span id="local-6989586621679078290"><span class="annot"><span class="annottext">time :: Time
</span><a href="#local-6989586621679078290"><span class="hs-identifier hs-var hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Time
</span><a href="Test.Tasty.Core.html#resultTime"><span class="hs-identifier hs-var hs-var">resultTime</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-142"></span><span>          </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
</span><a href="#local-6989586621679078298"><span class="hs-identifier hs-var">printFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><a href="Test.Tasty.Core.html#resultShortDescription"><span class="hs-identifier hs-var hs-var">resultShortDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-comment">-- print time only if it's significant</span><span>
</span><span id="line-144"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078290"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><span class="hs-number">0.01</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
</span><a href="#local-6989586621679078298"><span class="hs-identifier hs-var">printFn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Time -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot; (%.2fs)&quot;</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078290"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>          </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
</span><a href="#local-6989586621679078298"><span class="hs-identifier hs-var">printFn</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078301"><span class="hs-identifier hs-var">rDesc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.Tasty.Core.html#resultSuccessful"><span class="hs-identifier hs-var">resultSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoOk"><span class="hs-identifier hs-var">infoOk</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoFail"><span class="hs-identifier hs-var">infoFail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-150"></span><span>              </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%s%s\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; TestName) -&gt; Int -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestName -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#formatDesc"><span class="hs-identifier hs-var">formatDesc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078301"><span class="hs-identifier hs-var">rDesc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; ResultDetailsPrinter
</span><a href="Test.Tasty.Core.html#resultDetailsPrinter"><span class="hs-identifier hs-var hs-var">resultDetailsPrinter</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078302"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>            </span><span class="annot"><a href="Test.Tasty.Providers.ConsoleFormat.html#ResultDetailsPrinter"><span class="hs-identifier hs-type">ResultDetailsPrinter</span></a></span><span> </span><span id="local-6989586621679078277"><span class="annot"><span class="annottext">Int -&gt; ConsoleFormatPrinter -&gt; IO ()
</span><a href="#local-6989586621679078277"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ConsoleFormatPrinter -&gt; IO ()
</span><a href="#local-6989586621679078277"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078314"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormatPrinter
ConsoleFormatPrinter
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#withConsoleFormat"><span class="hs-identifier hs-var">withConsoleFormat</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">TestOutput -&gt; Reader Int TestOutput
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TestOutput -&gt; Reader Int TestOutput)
-&gt; TestOutput -&gt; Reader Int TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; (Result -&gt; IO ()) -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintTest"><span class="hs-identifier hs-var">PrintTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078317"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078312"><span class="hs-identifier hs-var">printTestName</span></a></span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; Result -&gt; IO ()
Result -&gt; IO ()
</span><a href="#local-6989586621679078303"><span class="hs-identifier hs-var">printTestResult</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="#local-6989586621679078276"><span class="hs-identifier hs-type">runGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html#OptionSet"><span class="hs-identifier hs-type">OptionSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-type">Ap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Reader</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679078276"><span class="annot"><span class="annottext">runGroup :: OptionSet
-&gt; TestName
-&gt; Ap (Reader Int) TestOutput
-&gt; Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078276"><span class="hs-identifier hs-var hs-var">runGroup</span></a></span></span><span> </span><span id="local-6989586621679078275"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078275"><span class="hs-identifier hs-var">_opts</span></a></span></span><span> </span><span id="local-6989586621679078274"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078274"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078273"><span class="annot"><span class="annottext">Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078273"><span class="hs-identifier hs-var">grp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput)
-&gt; Reader Int TestOutput -&gt; Ap (Reader Int) TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679078272"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078272"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Reader Int Int
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">let</span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679078271"><span class="annot"><span class="annottext">printHeading :: IO ()
</span><a href="#local-6989586621679078271"><span class="hs-identifier hs-var hs-var">printHeading</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName -&gt; IO ()
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%s%s\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078272"><span class="hs-identifier hs-var">level</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078274"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679078270"><span class="annot"><span class="annottext">printBody :: TestOutput
</span><a href="#local-6989586621679078270"><span class="hs-identifier hs-var hs-var">printBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Reader Int TestOutput -&gt; Int -&gt; TestOutput
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ap (Reader Int) TestOutput -&gt; Reader Int TestOutput
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078273"><span class="hs-identifier hs-var">grp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078272"><span class="hs-identifier hs-var">level</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>      </span><span class="annot"><span class="annottext">TestOutput -&gt; Reader Int TestOutput
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TestOutput -&gt; Reader Int TestOutput)
-&gt; TestOutput -&gt; Reader Int TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintHeading"><span class="hs-identifier hs-var">PrintHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078274"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078271"><span class="hs-identifier hs-var">printHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078270"><span class="hs-identifier hs-var">printBody</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">(Reader Int TestOutput -&gt; Int -&gt; TestOutput)
-&gt; Int -&gt; Reader Int TestOutput -&gt; TestOutput
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Reader Int TestOutput -&gt; Int -&gt; TestOutput
forall r a. Reader r a -&gt; r -&gt; a
</span><span class="hs-identifier hs-var">runReader</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Reader Int TestOutput -&gt; TestOutput)
-&gt; Reader Int TestOutput -&gt; TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ap (Reader Int) TestOutput -&gt; Reader Int TestOutput
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Ap (Reader Int) TestOutput -&gt; Reader Int TestOutput)
-&gt; Ap (Reader Int) TestOutput -&gt; Reader Int TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">TreeFold (Ap (Reader Int) TestOutput)
-&gt; OptionSet -&gt; TestTree -&gt; Ap (Reader Int) TestOutput
forall b. Monoid b =&gt; TreeFold b -&gt; OptionSet -&gt; TestTree -&gt; b
</span><a href="Test.Tasty.Core.html#foldTestTree"><span class="hs-identifier hs-var">foldTestTree</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">TreeFold (Ap (Reader Int) TestOutput)
forall b. Monoid b =&gt; TreeFold b
</span><a href="Test.Tasty.Core.html#trivialFold"><span class="hs-identifier hs-var">trivialFold</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">foldSingle :: forall t.
IsTest t =&gt;
OptionSet -&gt; TestName -&gt; t -&gt; Ap (Reader Int) TestOutput
</span><a href="Test.Tasty.Core.html#foldSingle"><span class="hs-identifier hs-var">foldSingle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall t.
(IsTest t, ?colors::Bool) =&gt;
OptionSet -&gt; TestName -&gt; t -&gt; Ap (Reader Int) TestOutput
forall t.
IsTest t =&gt;
OptionSet -&gt; TestName -&gt; t -&gt; Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078319"><span class="hs-identifier hs-var">runSingleTest</span></a></span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">foldGroup :: OptionSet
-&gt; TestName
-&gt; Ap (Reader Int) TestOutput
-&gt; Ap (Reader Int) TestOutput
</span><a href="Test.Tasty.Core.html#foldGroup"><span class="hs-identifier hs-var">foldGroup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet
-&gt; TestName
-&gt; Ap (Reader Int) TestOutput
-&gt; Ap (Reader Int) TestOutput
</span><a href="#local-6989586621679078276"><span class="hs-identifier hs-var">runGroup</span></a></span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078323"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078322"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Fold function for the 'TestOutput' tree into a 'Monoid'.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- @since 0.12</span><span>
</span><span id="line-176"></span><span id="local-6989586621679078482"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier hs-type">foldTestOutput</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679078482"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078482"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- ^ Eliminator for test cases. The @IO ()@ prints the testname. The</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- @IO Result@ blocks until the test is finished, returning it's 'Result'.</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- The @Result -&gt; IO ()@ function prints the formatted output.</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078482"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078482"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-comment">-- ^ Eliminator for test groups. The @IO ()@ prints the test group's name.</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-comment">-- The @b@ is the result of folding the test group.</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-comment">-- ^ The @TestOutput@ being rendered.</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span> </span><span class="hs-comment">-- ^ The @StatusMap@ received by the 'TestReporter'</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078482"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-188"></span><span id="foldTestOutput"><span class="annot"><span class="annottext">foldTestOutput :: (TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b)
-&gt; (TestName -&gt; IO () -&gt; b -&gt; b) -&gt; TestOutput -&gt; StatusMap -&gt; b
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier hs-var hs-var">foldTestOutput</span></a></span></span><span> </span><span id="local-6989586621679078262"><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b
</span><a href="#local-6989586621679078262"><span class="hs-identifier hs-var">foldTest</span></a></span></span><span> </span><span id="local-6989586621679078261"><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; b -&gt; b
</span><a href="#local-6989586621679078261"><span class="hs-identifier hs-var">foldHeading</span></a></span></span><span> </span><span id="local-6989586621679078260"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078260"><span class="hs-identifier hs-var">outputTree</span></a></span></span><span> </span><span id="local-6989586621679078259"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078259"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><span class="annottext">(State Int b -&gt; Int -&gt; b) -&gt; Int -&gt; State Int b -&gt; b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">State Int b -&gt; Int -&gt; b
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(State Int b -&gt; b) -&gt; State Int b -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ap (StateT Int Identity) b -&gt; State Int b
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Ap (StateT Int Identity) b -&gt; State Int b)
-&gt; Ap (StateT Int Identity) b -&gt; State Int b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestOutput -&gt; Ap (StateT Int Identity) b
forall (f :: * -&gt; *). MonadState Int f =&gt; TestOutput -&gt; Ap f b
</span><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078260"><span class="hs-identifier hs-var">outputTree</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679078257"><span class="annot"><span class="annottext">go :: TestOutput -&gt; Ap f b
</span><a href="#local-6989586621679078257"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintTest"><span class="hs-identifier hs-type">PrintTest</span></a></span><span> </span><span id="local-6989586621679078256"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078256"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078255"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078255"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078254"><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078254"><span class="hs-identifier hs-var">printResult</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; Ap f b
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; Ap f b) -&gt; f b -&gt; Ap f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679078253"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078253"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f Int
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; f ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f ()) -&gt; Int -&gt; f ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078253"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-194"></span><span>      </span><span id="local-6989586621679078249"><span class="annot"><span class="annottext">statusVar :: TVar Status
</span><a href="#local-6989586621679078249"><span class="hs-identifier hs-var hs-var">statusVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">TVar Status -&gt; Maybe (TVar Status) -&gt; TVar Status
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; TVar Status
forall a. HasCallStack =&gt; TestName -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;internal error: index out of bounds&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (TVar Status) -&gt; TVar Status)
-&gt; Maybe (TVar Status) -&gt; TVar Status
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; StatusMap -&gt; Maybe (TVar Status)
forall a. Int -&gt; IntMap a -&gt; Maybe a
</span><span class="hs-identifier hs-var">IntMap.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078253"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078259"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-197"></span><span>      </span><span id="local-6989586621679078245"><span class="annot"><span class="annottext">readStatusVar :: IO Result
</span><a href="#local-6989586621679078245"><span class="hs-identifier hs-var hs-var">readStatusVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; IO Result
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getResultFromTVar"><span class="hs-identifier hs-var">getResultFromTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679078249"><span class="hs-identifier hs-var">statusVar</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="annottext">b -&gt; f b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; f b) -&gt; b -&gt; f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b
</span><a href="#local-6989586621679078262"><span class="hs-identifier hs-var">foldTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078256"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078255"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="annot"><span class="annottext">IO Result
</span><a href="#local-6989586621679078245"><span class="hs-identifier hs-var">readStatusVar</span></a></span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078254"><span class="hs-identifier hs-var">printResult</span></a></span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#PrintHeading"><span class="hs-identifier hs-type">PrintHeading</span></a></span><span> </span><span id="local-6989586621679078243"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078243"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679078242"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078242"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078241"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078241"><span class="hs-identifier hs-var">printBody</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f b -&gt; Ap f b
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(f b -&gt; Ap f b) -&gt; f b -&gt; Ap f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; b -&gt; b
</span><a href="#local-6989586621679078261"><span class="hs-identifier hs-var">foldHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078243"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078242"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; f b -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ap f b -&gt; f b
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOutput -&gt; Ap f b
</span><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078241"><span class="hs-identifier hs-var">printBody</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span id="local-6989586621679078239"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078239"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679078238"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078238"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ap f b -&gt; Ap f b -&gt; Ap f b
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mappend</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOutput -&gt; Ap f b
</span><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078239"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestOutput -&gt; Ap f b
</span><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078238"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="#local-6989586621679078257"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Skip"><span class="hs-identifier hs-var">Skip</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ap f b
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- TestOutput modes</span><span>
</span><span id="line-208"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutput"><span class="hs-identifier hs-type">consoleOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span id="consoleOutput"><span class="annot"><span class="annottext">consoleOutput :: TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutput"><span class="hs-identifier hs-var hs-var">consoleOutput</span></a></span></span><span> </span><span id="local-6989586621679078236"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078236"><span class="hs-identifier hs-var">toutput</span></a></span></span><span> </span><span id="local-6989586621679078235"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078235"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">Traversal IO -&gt; IO ()
forall (f :: * -&gt; *). Traversal f -&gt; f ()
</span><a href="Test.Tasty.Runners.Reducers.html#getTraversal"><span class="hs-identifier hs-var hs-var">getTraversal</span></a></span><span> </span><span class="annot"><span class="annottext">(Traversal IO -&gt; IO ())
-&gt; ((Traversal IO, Any) -&gt; Traversal IO)
-&gt; (Traversal IO, Any)
-&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Traversal IO, Any) -&gt; Traversal IO
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((Traversal IO, Any) -&gt; IO ()) -&gt; (Traversal IO, Any) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TestName
 -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; (Traversal IO, Any))
-&gt; (TestName
    -&gt; IO () -&gt; (Traversal IO, Any) -&gt; (Traversal IO, Any))
-&gt; TestOutput
-&gt; StatusMap
-&gt; (Traversal IO, Any)
forall b.
Monoid b =&gt;
(TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b)
-&gt; (TestName -&gt; IO () -&gt; b -&gt; b) -&gt; TestOutput -&gt; StatusMap -&gt; b
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier hs-var">foldTestOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
-&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; (Traversal IO, Any)
forall p t.
p -&gt; IO () -&gt; IO t -&gt; (t -&gt; IO ()) -&gt; (Traversal IO, Any)
</span><a href="#local-6989586621679078232"><span class="hs-identifier hs-var">foldTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; (Traversal IO, Any) -&gt; (Traversal IO, Any)
forall p. p -&gt; IO () -&gt; (Traversal IO, Any) -&gt; (Traversal IO, Any)
</span><a href="#local-6989586621679078231"><span class="hs-identifier hs-var">foldHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078236"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078235"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679078232"><span class="annot"><span class="annottext">foldTest :: p -&gt; IO () -&gt; IO t -&gt; (t -&gt; IO ()) -&gt; (Traversal IO, Any)
</span><a href="#local-6989586621679078232"><span class="hs-identifier hs-var hs-var">foldTest</span></a></span></span><span> </span><span id="local-6989586621679078230"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078230"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078229"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078229"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078228"><span class="annot"><span class="annottext">IO t
</span><a href="#local-6989586621679078228"><span class="hs-identifier hs-var">getResult</span></a></span></span><span> </span><span id="local-6989586621679078227"><span class="annot"><span class="annottext">t -&gt; IO ()
</span><a href="#local-6989586621679078227"><span class="hs-identifier hs-var">printResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Traversal IO
forall (f :: * -&gt; *). f () -&gt; Traversal f
</span><a href="Test.Tasty.Runners.Reducers.html#Traversal"><span class="hs-identifier hs-var">Traversal</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Traversal IO) -&gt; IO () -&gt; Traversal IO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>          </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078229"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>          </span><span id="local-6989586621679078225"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679078225"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO t
</span><a href="#local-6989586621679078228"><span class="hs-identifier hs-var">getResult</span></a></span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><span class="annottext">t -&gt; IO ()
</span><a href="#local-6989586621679078227"><span class="hs-identifier hs-var">printResult</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679078225"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679078231"><span class="annot"><span class="annottext">foldHeading :: p -&gt; IO () -&gt; (Traversal IO, Any) -&gt; (Traversal IO, Any)
</span><a href="#local-6989586621679078231"><span class="hs-identifier hs-var hs-var">foldHeading</span></a></span></span><span> </span><span id="local-6989586621679078223"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078223"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078222"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078222"><span class="hs-identifier hs-var">printHeading</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078221"><span class="annot"><span class="annottext">Traversal IO
</span><a href="#local-6989586621679078221"><span class="hs-identifier hs-var">printBody</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span> </span><span id="local-6989586621679078220"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078220"><span class="hs-identifier hs-var">nonempty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; Traversal IO
forall (f :: * -&gt; *). f () -&gt; Traversal f
</span><a href="Test.Tasty.Runners.Reducers.html#Traversal"><span class="hs-identifier hs-var">Traversal</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; Traversal IO) -&gt; IO () -&gt; Traversal IO
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078220"><span class="hs-identifier hs-var">nonempty</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078222"><span class="hs-identifier hs-var">printHeading</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Traversal IO -&gt; IO ()
forall (f :: * -&gt; *). Traversal f -&gt; f ()
</span><a href="Test.Tasty.Runners.Reducers.html#getTraversal"><span class="hs-identifier hs-var hs-var">getTraversal</span></a></span><span> </span><span class="annot"><span class="annottext">Traversal IO
</span><a href="#local-6989586621679078221"><span class="hs-identifier hs-var">printBody</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078220"><span class="hs-identifier hs-var">nonempty</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutputHidingSuccesses"><span class="hs-identifier hs-type">consoleOutputHidingSuccesses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span id="consoleOutputHidingSuccesses"><span class="annot"><span class="annottext">consoleOutputHidingSuccesses :: TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutputHidingSuccesses"><span class="hs-identifier hs-var hs-var">consoleOutputHidingSuccesses</span></a></span></span><span> </span><span id="local-6989586621679078218"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078218"><span class="hs-identifier hs-var">toutput</span></a></span></span><span> </span><span id="local-6989586621679078217"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">IO Any -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO Any -&gt; IO ()) -&gt; (Ap IO Any -&gt; IO Any) -&gt; Ap IO Any -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ap IO Any -&gt; IO Any
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Ap IO Any -&gt; IO ()) -&gt; Ap IO Any -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap IO Any)
-&gt; (TestName -&gt; IO () -&gt; Ap IO Any -&gt; Ap IO Any)
-&gt; TestOutput
-&gt; StatusMap
-&gt; Ap IO Any
forall b.
Monoid b =&gt;
(TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b)
-&gt; (TestName -&gt; IO () -&gt; b -&gt; b) -&gt; TestOutput -&gt; StatusMap -&gt; b
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier hs-var">foldTestOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap IO Any
forall p. p -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap IO Any
</span><a href="#local-6989586621679078215"><span class="hs-identifier hs-var">foldTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO () -&gt; Ap IO Any -&gt; Ap IO Any
forall p. p -&gt; IO () -&gt; Ap IO Any -&gt; Ap IO Any
</span><a href="#local-6989586621679078214"><span class="hs-identifier hs-var">foldHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078218"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679078215"><span class="annot"><span class="annottext">foldTest :: p -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap IO Any
</span><a href="#local-6989586621679078215"><span class="hs-identifier hs-var hs-var">foldTest</span></a></span></span><span> </span><span id="local-6989586621679078213"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078213"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078212"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078212"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078211"><span class="annot"><span class="annottext">IO Result
</span><a href="#local-6989586621679078211"><span class="hs-identifier hs-var">getResult</span></a></span></span><span> </span><span id="local-6989586621679078210"><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078210"><span class="hs-identifier hs-var">printResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><span class="annottext">IO Any -&gt; Ap IO Any
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Any -&gt; Ap IO Any) -&gt; IO Any -&gt; Ap IO Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-232"></span><span>          </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078212"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>          </span><span id="local-6989586621679078209"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078209"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Result
</span><a href="#local-6989586621679078211"><span class="hs-identifier hs-var">getResult</span></a></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.Tasty.Core.html#resultSuccessful"><span class="hs-identifier hs-var">resultSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078209"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078208"><span class="hs-identifier hs-var">clearThisLine</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Any -&gt; IO Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; IO Any) -&gt; Any -&gt; IO Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078210"><span class="hs-identifier hs-var">printResult</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078209"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Any -&gt; IO Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; IO Any) -&gt; Any -&gt; IO Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679078214"><span class="annot"><span class="annottext">foldHeading :: p -&gt; IO () -&gt; Ap IO Any -&gt; Ap IO Any
</span><a href="#local-6989586621679078214"><span class="hs-identifier hs-var hs-var">foldHeading</span></a></span></span><span> </span><span id="local-6989586621679078207"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078207"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078206"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078206"><span class="hs-identifier hs-var">printHeading</span></a></span></span><span> </span><span id="local-6989586621679078205"><span class="annot"><span class="annottext">Ap IO Any
</span><a href="#local-6989586621679078205"><span class="hs-identifier hs-var">printBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><span class="annottext">IO Any -&gt; Ap IO Any
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Any -&gt; Ap IO Any) -&gt; IO Any -&gt; Ap IO Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078206"><span class="hs-identifier hs-var">printHeading</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span> </span><span id="local-6989586621679078204"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078204"><span class="hs-identifier hs-var">failed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ap IO Any -&gt; IO Any
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">Ap IO Any
</span><a href="#local-6989586621679078205"><span class="hs-identifier hs-var">printBody</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078204"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078202"><span class="hs-identifier hs-var">clearAboveLine</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Any -&gt; IO Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; IO Any) -&gt; Any -&gt; IO Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078204"><span class="hs-identifier hs-var">failed</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679078202"><span class="annot"><span class="annottext">clearAboveLine :: IO ()
</span><a href="#local-6989586621679078202"><span class="hs-identifier hs-var hs-var">clearAboveLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">cursorUpLine</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078208"><span class="hs-identifier hs-var">clearThisLine</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679078208"><span class="annot"><span class="annottext">clearThisLine :: IO ()
</span><a href="#local-6989586621679078208"><span class="hs-identifier hs-var hs-var">clearThisLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier hs-var">clearLine</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">setCursorColumn</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#streamOutputHidingSuccesses"><span class="hs-identifier hs-type">streamOutputHidingSuccesses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#TestOutput"><span class="hs-identifier hs-type">TestOutput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span id="streamOutputHidingSuccesses"><span class="annot"><span class="annottext">streamOutputHidingSuccesses :: TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#streamOutputHidingSuccesses"><span class="hs-identifier hs-var hs-var">streamOutputHidingSuccesses</span></a></span></span><span> </span><span id="local-6989586621679078197"><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078197"><span class="hs-identifier hs-var">toutput</span></a></span></span><span> </span><span id="local-6989586621679078196"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078196"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">IO Any -&gt; IO ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(IO Any -&gt; IO ())
-&gt; (Ap (StateT [IO ()] IO) Any -&gt; IO Any)
-&gt; Ap (StateT [IO ()] IO) Any
-&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(StateT [IO ()] IO Any -&gt; [IO ()] -&gt; IO Any)
-&gt; [IO ()] -&gt; StateT [IO ()] IO Any -&gt; IO Any
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT [IO ()] IO Any -&gt; [IO ()] -&gt; IO Any
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(StateT [IO ()] IO Any -&gt; IO Any)
-&gt; (Ap (StateT [IO ()] IO) Any -&gt; StateT [IO ()] IO Any)
-&gt; Ap (StateT [IO ()] IO) Any
-&gt; IO Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ap (StateT [IO ()] IO) Any -&gt; StateT [IO ()] IO Any
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Ap (StateT [IO ()] IO) Any -&gt; IO ())
-&gt; Ap (StateT [IO ()] IO) Any -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="annottext">(TestName
 -&gt; IO ()
 -&gt; IO Result
 -&gt; (Result -&gt; IO ())
 -&gt; Ap (StateT [IO ()] IO) Any)
-&gt; (TestName
    -&gt; IO ()
    -&gt; Ap (StateT [IO ()] IO) Any
    -&gt; Ap (StateT [IO ()] IO) Any)
-&gt; TestOutput
-&gt; StatusMap
-&gt; Ap (StateT [IO ()] IO) Any
forall b.
Monoid b =&gt;
(TestName -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; b)
-&gt; (TestName -&gt; IO () -&gt; b -&gt; b) -&gt; TestOutput -&gt; StatusMap -&gt; b
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#foldTestOutput"><span class="hs-identifier hs-var">foldTestOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
-&gt; IO ()
-&gt; IO Result
-&gt; (Result -&gt; IO ())
-&gt; Ap (StateT [IO ()] IO) Any
forall a (f :: * -&gt; *) p.
(MonadState [IO a] f, MonadIO f) =&gt;
p -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap f Any
</span><a href="#local-6989586621679078194"><span class="hs-identifier hs-var">foldTest</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
-&gt; IO ()
-&gt; Ap (StateT [IO ()] IO) Any
-&gt; Ap (StateT [IO ()] IO) Any
forall a (f :: * -&gt; *) p.
MonadState [a] f =&gt;
p -&gt; a -&gt; Ap f Any -&gt; Ap f Any
</span><a href="#local-6989586621679078193"><span class="hs-identifier hs-var">foldHeading</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078197"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078196"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621679078194"><span class="annot"><span class="annottext">foldTest :: p -&gt; IO () -&gt; IO Result -&gt; (Result -&gt; IO ()) -&gt; Ap f Any
</span><a href="#local-6989586621679078194"><span class="hs-identifier hs-var hs-var">foldTest</span></a></span></span><span> </span><span id="local-6989586621679078192"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078192"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078191"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078191"><span class="hs-identifier hs-var">printName</span></a></span></span><span> </span><span id="local-6989586621679078190"><span class="annot"><span class="annottext">IO Result
</span><a href="#local-6989586621679078190"><span class="hs-identifier hs-var">getResult</span></a></span></span><span> </span><span id="local-6989586621679078189"><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078189"><span class="hs-identifier hs-var">printResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><span class="annottext">f Any -&gt; Ap f Any
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; Ap f Any) -&gt; f Any -&gt; Ap f Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-255"></span><span>          </span><span id="local-6989586621679078188"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078188"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Result -&gt; f Result
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO Result -&gt; f Result) -&gt; IO Result -&gt; f Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO Result
</span><a href="#local-6989586621679078190"><span class="hs-identifier hs-var">getResult</span></a></span><span>
</span><span id="line-256"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.Tasty.Core.html#resultSuccessful"><span class="hs-identifier hs-var">resultSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078188"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-257"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; f Any) -&gt; Any -&gt; f Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-258"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>              </span><span id="local-6989586621679078186"><span class="annot"><span class="annottext">[IO a]
</span><a href="#local-6989586621679078186"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">f [IO a]
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-260"></span><span>              </span><span class="annot"><span class="annottext">[IO a] -&gt; f ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>              </span><span class="annot"><span class="annottext">IO () -&gt; f ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; f ()) -&gt; IO () -&gt; f ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>                </span><span class="annot"><span class="annottext">[IO a] -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, Monad m) =&gt;
t (m a) -&gt; m ()
</span><span class="hs-identifier hs-var">sequence_</span></span><span> </span><span class="annot"><span class="annottext">([IO a] -&gt; IO ()) -&gt; [IO a] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[IO a] -&gt; [IO a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[IO a]
</span><a href="#local-6989586621679078186"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-264"></span><span>                </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679078191"><span class="hs-identifier hs-var">printName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>                </span><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="#local-6989586621679078189"><span class="hs-identifier hs-var">printResult</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078188"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>              </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; f Any) -&gt; Any -&gt; f Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679078193"><span class="annot"><span class="annottext">foldHeading :: p -&gt; a -&gt; Ap f Any -&gt; Ap f Any
</span><a href="#local-6989586621679078193"><span class="hs-identifier hs-var hs-var">foldHeading</span></a></span></span><span> </span><span id="local-6989586621679078183"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679078183"><span class="hs-identifier hs-var">_name</span></a></span></span><span> </span><span id="local-6989586621679078182"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">printHeading</span></a></span></span><span> </span><span id="local-6989586621679078181"><span class="annot"><span class="annottext">Ap f Any
</span><a href="#local-6989586621679078181"><span class="hs-identifier hs-var">printBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="annottext">f Any -&gt; Ap f Any
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; Ap f Any) -&gt; f Any -&gt; Ap f Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">printHeading</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Any</span></span><span> </span><span id="local-6989586621679078179"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078179"><span class="hs-identifier hs-var">failed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ap f Any -&gt; f Any
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">Ap f Any
</span><a href="#local-6989586621679078181"><span class="hs-identifier hs-var">printBody</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; f () -&gt; f ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078179"><span class="hs-identifier hs-var">failed</span></a></span><span> </span><span class="annot"><span class="annottext">(f () -&gt; f ()) -&gt; f () -&gt; f ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; f ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">(([a] -&gt; [a]) -&gt; f ()) -&gt; ([a] -&gt; [a]) -&gt; f ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078178"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078178"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078178"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-276"></span><span>              </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679078177"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078177"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679078177"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-277"></span><span>              </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- shouldn't happen anyway</span><span>
</span><span id="line-278"></span><span>        </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; f Any) -&gt; Any -&gt; f Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><span class="hs-identifier hs-var">Any</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078179"><span class="hs-identifier hs-var">failed</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- Statistics</span><span>
</span><span id="line-284"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Track the number of tests that were run and failures of a 'TestTree' or</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- sub-tree.</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-291"></span><span class="hs-keyword">data</span><span> </span><span id="Statistics"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-var">Statistics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Statistics"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-var">Statistics</span></a></span></span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="statTotal"><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statTotal"><span class="hs-identifier hs-var hs-var">statTotal</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of active tests (e.g., that match the</span><span>
</span><span id="line-293"></span><span>                      </span><span class="hs-comment">-- pattern specified on the commandline), inactive tests</span><span>
</span><span id="line-294"></span><span>                      </span><span class="hs-comment">-- are not counted.</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="statFailures"><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statFailures"><span class="hs-identifier hs-var hs-var">statFailures</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of active tests that failed.</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078169"><span id="local-6989586621679078171"><span class="annot"><span class="hs-identifier hs-type">Sem.Semigroup</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span> </span><span id="local-6989586621679078168"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078168"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679078167"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078167"><span class="hs-identifier hs-var">f1</span></a></span></span><span> </span><span id="local-6989586621679078166"><span class="annot"><span class="annottext">&lt;&gt; :: Statistics -&gt; Statistics -&gt; Statistics
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span> </span><span id="local-6989586621679078165"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078165"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679078164"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078164"><span class="hs-identifier hs-var">f2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Statistics
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-var">Statistics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078168"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078165"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078167"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078164"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078158"><span id="local-6989586621679078160"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>  </span><span id="local-6989586621679078157"><span class="annot"><span class="annottext">mempty :: Statistics
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Statistics
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-var">Statistics</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span>  </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">Sem.&lt;&gt;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | @computeStatistics@ computes a summary 'Statistics' for</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- a given state of the 'StatusMap'.</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- Useful in combination with @printStatistics@</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeStatistics"><span class="hs-identifier hs-type">computeStatistics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span>
</span><span id="line-310"></span><span id="computeStatistics"><span class="annot"><span class="annottext">computeStatistics :: StatusMap -&gt; IO Statistics
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeStatistics"><span class="hs-identifier hs-var hs-var">computeStatistics</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ap IO Statistics -&gt; IO Statistics
forall (f :: * -&gt; *) a. Ap f a -&gt; f a
</span><a href="Test.Tasty.Runners.Reducers.html#getApp"><span class="hs-identifier hs-var hs-var">getApp</span></a></span><span> </span><span class="annot"><span class="annottext">(Ap IO Statistics -&gt; IO Statistics)
-&gt; (StatusMap -&gt; Ap IO Statistics) -&gt; StatusMap -&gt; IO Statistics
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TVar Status -&gt; Ap IO Statistics) -&gt; StatusMap -&gt; Ap IO Statistics
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078155"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679078155"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Statistics -&gt; Ap IO Statistics
forall (f :: * -&gt; *) a. f a -&gt; Ap f a
</span><a href="Test.Tasty.Runners.Reducers.html#Ap"><span class="hs-identifier hs-var">Ap</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Statistics -&gt; Ap IO Statistics)
-&gt; IO Statistics -&gt; Ap IO Statistics
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078154"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078154"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Statistics
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-var">Statistics</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.Tasty.Core.html#resultSuccessful"><span class="hs-identifier hs-var">resultSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078154"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">(Result -&gt; Statistics) -&gt; IO Result -&gt; IO Statistics
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; IO Result
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getResultFromTVar"><span class="hs-identifier hs-var">getResultFromTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679078155"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#reportStatistics"><span class="hs-identifier hs-type">reportStatistics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span id="reportStatistics"><span class="annot"><span class="annottext">reportStatistics :: Statistics -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#reportStatistics"><span class="hs-identifier hs-var hs-var">reportStatistics</span></a></span></span><span> </span><span id="local-6989586621679078152"><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statFailures"><span class="hs-identifier hs-var hs-var">statFailures</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Int -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;All %d tests passed&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statTotal"><span class="hs-identifier hs-var hs-var">statTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679078151"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078151"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#fail"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Int -&gt; Int -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%d out of %d tests failed&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078151"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statTotal"><span class="hs-identifier hs-var hs-var">statTotal</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | @printStatistics@ reports test success/failure statistics and time it took</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- to run. The 'Time' results is intended to be filled in by the 'TestReporter'</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- callback. The @colors@ ImplicitParam controls whether coloured output is</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- used.</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-325"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatistics"><span class="hs-identifier hs-type">printStatistics</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="printStatistics"><span class="annot"><span class="annottext">printStatistics :: Statistics -&gt; Time -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatistics"><span class="hs-identifier hs-var hs-var">printStatistics</span></a></span></span><span> </span><span id="local-6989586621679078150"><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679078149"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078149"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; Statistics -&gt; IO ()
Statistics -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#reportStatistics"><span class="hs-identifier hs-var">reportStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statFailures"><span class="hs-identifier hs-var hs-var">statFailures</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#ok"><span class="hs-identifier hs-var">ok</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Time -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot; (%.2fs)\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078149"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestName -&gt; IO ()
TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#fail"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Time -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot; (%.2fs)\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078149"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | @printStatisticsNoTime@ reports test success/failure statistics</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- The @colors@ ImplicitParam controls whether coloured output is used.</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">-- @since 0.12</span><span>
</span><span id="line-337"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatisticsNoTime"><span class="hs-identifier hs-type">printStatisticsNoTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Statistics"><span class="hs-identifier hs-type">Statistics</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span id="printStatisticsNoTime"><span class="annot"><span class="annottext">printStatisticsNoTime :: Statistics -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatisticsNoTime"><span class="hs-identifier hs-var hs-var">printStatisticsNoTime</span></a></span></span><span> </span><span id="local-6989586621679078148"><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078148"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; Statistics -&gt; IO ()
Statistics -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#reportStatistics"><span class="hs-identifier hs-var">reportStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078148"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
forall r. PrintfType r =&gt; TestName -&gt; r
</span><span class="hs-identifier hs-var">printf</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Wait until</span><span>
</span><span id="line-341"></span><span class="hs-comment">--</span><span>
</span><span id="line-342"></span><span class="hs-comment">-- * all tests have finished successfully, and return 'True', or</span><span>
</span><span id="line-343"></span><span class="hs-comment">--</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- * at least one test has failed, and return 'False'</span><span>
</span><span id="line-345"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statusMapResult"><span class="hs-identifier hs-type">statusMapResult</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ lookahead</span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#StatusMap"><span class="hs-identifier hs-type">StatusMap</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-349"></span><span id="statusMapResult"><span class="annot"><span class="annottext">statusMapResult :: Int -&gt; StatusMap -&gt; IO Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statusMapResult"><span class="hs-identifier hs-var hs-var">statusMapResult</span></a></span></span><span> </span><span id="local-6989586621679078146"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078146"><span class="hs-identifier hs-var">lookahead0</span></a></span></span><span> </span><span id="local-6989586621679078145"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078145"><span class="hs-identifier hs-var">smap</span></a></span></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">StatusMap -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IntMap.null</span></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078145"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><span class="annottext">IO (IO Bool) -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(IO (IO Bool) -&gt; IO Bool)
-&gt; (STM (IO Bool) -&gt; IO (IO Bool)) -&gt; STM (IO Bool) -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">STM (IO Bool) -&gt; IO (IO Bool)
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM (IO Bool) -&gt; IO Bool) -&gt; STM (IO Bool) -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="annottext">(Int
 -&gt; TVar Status
 -&gt; (IntMap () -&gt; Int -&gt; STM (IO Bool))
 -&gt; IntMap ()
 -&gt; Int
 -&gt; STM (IO Bool))
-&gt; (IntMap () -&gt; Int -&gt; STM (IO Bool))
-&gt; StatusMap
-&gt; IntMap ()
-&gt; Int
-&gt; STM (IO Bool)
forall a b. (Int -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; IntMap a -&gt; b
</span><span class="hs-identifier hs-var">IntMap.foldrWithKey</span></span><span> </span><span class="annot"><span class="annottext">Int
-&gt; TVar Status
-&gt; (IntMap () -&gt; Int -&gt; STM (IO Bool))
-&gt; IntMap ()
-&gt; Int
-&gt; STM (IO Bool)
</span><a href="#local-6989586621679078141"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap () -&gt; Int -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078140"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078145"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ()
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078146"><span class="hs-identifier hs-var">lookahead0</span></a></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><a href="#local-6989586621679078141"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-356"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TVar</span></span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span>
</span><span id="line-357"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IntMap.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-comment">-- ok_tests is a set of tests that completed successfully</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-comment">-- lookahead is the number of unfinished tests that we are allowed to</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-comment">-- look at</span><span>
</span><span id="line-362"></span><span>    </span><span id="local-6989586621679078141"><span class="annot"><span class="annottext">f :: Int
-&gt; TVar Status
-&gt; (IntMap () -&gt; Int -&gt; STM (IO Bool))
-&gt; IntMap ()
-&gt; Int
-&gt; STM (IO Bool)
</span><a href="#local-6989586621679078141"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679078139"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078139"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679078138"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679078138"><span class="hs-identifier hs-var">tvar</span></a></span></span><span> </span><span id="local-6989586621679078137"><span class="annot"><span class="annottext">IntMap () -&gt; Int -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078137"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679078136"><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078136"><span class="hs-identifier hs-var">ok_tests</span></a></span></span><span> </span><span id="local-6989586621679078135"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078135"><span class="hs-identifier hs-var">lookahead</span></a></span></span><span>
</span><span id="line-363"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078135"><span class="hs-identifier hs-var">lookahead</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>          </span><span class="hs-comment">-- We looked at too many unfinished tests.</span><span>
</span><span id="line-365"></span><span>          </span><span class="annot"><span class="annottext">IntMap () -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var">next_iter</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078136"><span class="hs-identifier hs-var">ok_tests</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>          </span><span id="local-6989586621679078132"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">this_status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><span class="hs-identifier hs-var">readTVar</span></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679078138"><span class="hs-identifier hs-var">tvar</span></a></span><span>
</span><span id="line-368"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">this_status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>            </span><span class="annot"><a href="Test.Tasty.Run.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span id="local-6989586621679078129"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078129"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><a href="Test.Tasty.Core.html#resultSuccessful"><span class="hs-identifier hs-var">resultSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078129"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IntMap () -&gt; Int -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078137"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; () -&gt; IntMap () -&gt; IntMap ()
forall a. Int -&gt; a -&gt; IntMap a -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.insert</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078139"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078136"><span class="hs-identifier hs-var">ok_tests</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078135"><span class="hs-identifier hs-var">lookahead</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; STM (IO Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; STM (IO Bool)) -&gt; IO Bool -&gt; STM (IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-373"></span><span>            </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IntMap () -&gt; Int -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078137"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078136"><span class="hs-identifier hs-var">ok_tests</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078135"><span class="hs-identifier hs-var">lookahead</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-comment">-- next_iter is called when we end the current iteration,</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-comment">-- either because we reached the end of the test tree</span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-comment">-- or because we exhausted the lookahead</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="#local-6989586621679078133"><span class="hs-identifier hs-type">next_iter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>    </span><span id="local-6989586621679078133"><span class="annot"><span class="annottext">next_iter :: IntMap () -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var hs-var">next_iter</span></a></span></span><span> </span><span id="local-6989586621679078127"><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">ok_tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-comment">-- If we made no progress at all, wait until at least some tests</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-comment">-- complete.</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-comment">-- Otherwise, reduce the set of tests we are looking at.</span><span>
</span><span id="line-383"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">IntMap () -&gt; Bool
forall a. IntMap a -&gt; Bool
</span><span class="hs-identifier hs-var">IntMap.null</span></span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">ok_tests</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">STM (IO Bool)
forall a. STM a
</span><span class="hs-identifier hs-var">retry</span></span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; STM (IO Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; STM (IO Bool)) -&gt; IO Bool -&gt; STM (IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; StatusMap -&gt; IO Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statusMapResult"><span class="hs-identifier hs-var">statusMapResult</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078146"><span class="hs-identifier hs-var">lookahead0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatusMap -&gt; IntMap () -&gt; StatusMap
forall a b. IntMap a -&gt; IntMap b -&gt; IntMap a
</span><span class="hs-identifier hs-var">IntMap.difference</span></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078145"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">ok_tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span>    </span><span class="annot"><a href="#local-6989586621679078140"><span class="hs-identifier hs-type">finish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IntMap.IntMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">STM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span id="local-6989586621679078140"><span class="annot"><span class="annottext">finish :: IntMap () -&gt; Int -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078140"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span id="local-6989586621679078124"><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078124"><span class="hs-identifier hs-var">ok_tests</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IntMap () -&gt; STM (IO Bool)
</span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var">next_iter</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap ()
</span><a href="#local-6989586621679078124"><span class="hs-identifier hs-var">ok_tests</span></a></span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-393"></span><span class="hs-comment">-- Console test reporter</span><span>
</span><span id="line-394"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-395"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | A simple console UI</span><span>
</span><span id="line-398"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporter"><span class="hs-identifier hs-type">consoleTestReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.html#Ingredient"><span class="hs-identifier hs-type">Ingredient</span></a></span><span>
</span><span id="line-399"></span><span id="consoleTestReporter"><span class="annot"><span class="annottext">consoleTestReporter :: Ingredient
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporter"><span class="hs-identifier hs-var hs-var">consoleTestReporter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
-&gt; Ingredient
</span><a href="Test.Tasty.Ingredients.html#TestReporter"><span class="hs-identifier hs-var">TestReporter</span></a></span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterOptions"><span class="hs-identifier hs-var">consoleTestReporterOptions</span></a></span><span> </span><span class="annot"><span class="annottext">((OptionSet
  -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
 -&gt; Ingredient)
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
-&gt; Ingredient
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078121"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679078120"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078120"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="Test.Tasty.Patterns.html#TestPattern"><span class="hs-identifier hs-type">TestPattern</span></a></span><span> </span><span id="local-6989586621679078118"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679078118"><span class="hs-identifier hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestPattern
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621679078116"><span class="annot"><span class="annottext">tests :: [TestName]
</span><a href="#local-6989586621679078116"><span class="hs-identifier hs-var hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; [TestName]
</span><a href="Test.Tasty.Ingredients.ListTests.html#testsNames"><span class="hs-identifier hs-var">testsNames</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078120"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679078114"><span class="annot"><span class="annottext">hook :: [TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; IO Result) -&gt; (Result -&gt; Result) -&gt; Result -&gt; IO Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Result -&gt; Result) -&gt; Result -&gt; IO Result)
-&gt; ([TestName] -&gt; Result -&gt; Result)
-&gt; [TestName]
-&gt; Result
-&gt; IO Result
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; Maybe Expr -&gt; [TestName] -&gt; Result -&gt; Result
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#appendPatternIfTestFailed"><span class="hs-identifier hs-var">appendPatternIfTestFailed</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078116"><span class="hs-identifier hs-var">tests</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679078118"><span class="hs-identifier hs-var">pattern</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="Test.Tasty.Ingredients.html#TestReporter"><span class="hs-identifier hs-type">TestReporter</span></a></span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078112"><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool))
</span><a href="#local-6989586621679078112"><span class="hs-identifier hs-var">cb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; Result -&gt; IO Result) -&gt; Ingredient
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterWithHook"><span class="hs-identifier hs-var">consoleTestReporterWithHook</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var">hook</span></a></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool))
</span><a href="#local-6989586621679078112"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078120"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#appendPatternIfTestFailed"><span class="hs-identifier hs-type">appendPatternIfTestFailed</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of (pre-intercalated) test names</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Tasty.Patterns.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-comment">-- ^ current pattern, if any</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ name of current test, represented as a list of group names</span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>     </span><span class="hs-comment">-- ^ vanilla result</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-413"></span><span id="appendPatternIfTestFailed"><span class="annot"><span class="annottext">appendPatternIfTestFailed :: [TestName] -&gt; Maybe Expr -&gt; [TestName] -&gt; Result -&gt; Result
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#appendPatternIfTestFailed"><span class="hs-identifier hs-var hs-var">appendPatternIfTestFailed</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078111"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078111"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078111"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-comment">-- if there is only one test, nothing to refine</span><span>
</span><span id="line-414"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#appendPatternIfTestFailed"><span class="hs-identifier hs-var">appendPatternIfTestFailed</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679078110"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078110"><span class="hs-identifier hs-var">res</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078110"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-comment">-- should be impossible</span><span>
</span><span id="line-415"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#appendPatternIfTestFailed"><span class="hs-identifier hs-var">appendPatternIfTestFailed</span></a></span><span> </span><span id="local-6989586621679078109"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078109"><span class="hs-identifier hs-var">tests</span></a></span></span><span> </span><span id="local-6989586621679078108"><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679078108"><span class="hs-identifier hs-var">currentPattern</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078107"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078107"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679078106"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078106"><span class="hs-identifier hs-var">names</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679078105"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Outcome
</span><a href="Test.Tasty.Core.html#resultOutcome"><span class="hs-identifier hs-var hs-var">resultOutcome</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">Outcome
</span><a href="Test.Tasty.Core.html#Success"><span class="hs-identifier hs-var">Success</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-417"></span><span>  </span><span class="annot"><a href="Test.Tasty.Core.html#Failure"><span class="hs-identifier hs-type">Failure</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">resultDescription :: TestName
</span><a href="Test.Tasty.Core.html#resultDescription"><span class="hs-identifier hs-var">resultDescription</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><a href="Test.Tasty.Core.html#resultDescription"><span class="hs-identifier hs-var hs-var">resultDescription</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679078105"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078104"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>    </span><span id="local-6989586621679078104"><span class="annot"><span class="annottext">msg :: TestName
</span><a href="#local-6989586621679078104"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;\nUse -p '&quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="#local-6989586621679078103"><span class="hs-identifier hs-var">escapeQuotes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; TestName
</span><a href="Test.Tasty.Patterns.Printer.html#printAwkExpr"><span class="hs-identifier hs-var">printAwkExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679078101"><span class="hs-identifier hs-var">pattern</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;' to rerun this test only.&quot;</span></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>    </span><span id="local-6989586621679078103"><span class="annot"><span class="annottext">escapeQuotes :: TestName -&gt; TestName
</span><a href="#local-6989586621679078103"><span class="hs-identifier hs-var hs-var">escapeQuotes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; TestName) -&gt; TestName -&gt; TestName
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; TestName) -&gt; TestName -&gt; TestName)
-&gt; (Char -&gt; TestName) -&gt; TestName -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078099"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;'\\''&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span>    </span><span id="local-6989586621679078098"><span class="annot"><span class="annottext">findPattern :: [TestName] -&gt; TestName -&gt; [TestName] -&gt; Expr
</span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var hs-var">findPattern</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span id="local-6989586621679078097"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#ERE"><span class="hs-identifier hs-var">ERE</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">findPattern</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621679078095"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078095"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#Field"><span class="hs-identifier hs-var">Field</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#IntLit"><span class="hs-identifier hs-var">IntLit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#StringLit"><span class="hs-identifier hs-var">StringLit</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078095"><span class="hs-identifier hs-var">pat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">findPattern</span></a></span><span> </span><span id="local-6989586621679078090"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078090"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span id="local-6989586621679078089"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078089"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078088"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078088"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679078087"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078087"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679078086"><span class="annot"><span class="annottext">pat' :: TestName
</span><a href="#local-6989586621679078086"><span class="hs-identifier hs-var hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078088"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078089"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><span class="annottext">[TestName] -&gt; TestName -&gt; [TestName] -&gt; Expr
</span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">findPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TestName -&gt; Bool) -&gt; [TestName] -&gt; [TestName]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078086"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isInfixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078090"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078086"><span class="hs-identifier hs-var">pat'</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078087"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679078085"><span class="annot"><span class="annottext">individualPattern :: Expr
</span><a href="#local-6989586621679078085"><span class="hs-identifier hs-var hs-var">individualPattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; TestName -&gt; [TestName] -&gt; Expr
</span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">findPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TestName -&gt; Bool) -&gt; [TestName] -&gt; [TestName]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078107"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isInfixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078109"><span class="hs-identifier hs-var">tests</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679078107"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679078106"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679078101"><span class="annot"><span class="annottext">pattern :: Expr
</span><a href="#local-6989586621679078101"><span class="hs-identifier hs-var hs-var">pattern</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Expr)
-&gt; (Expr -&gt; Expr -&gt; Expr) -&gt; Maybe Expr -&gt; Expr -&gt; Expr
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><a href="Test.Tasty.Patterns.Types.html#And"><span class="hs-identifier hs-var">And</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="#local-6989586621679078108"><span class="hs-identifier hs-var">currentPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679078085"><span class="hs-identifier hs-var">individualPattern</span></a></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterOptions"><span class="hs-identifier hs-type">consoleTestReporterOptions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Test.Tasty.Options.html#OptionDescription"><span class="hs-identifier hs-type">OptionDescription</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span id="consoleTestReporterOptions"><span class="annot"><span class="annottext">consoleTestReporterOptions :: [OptionDescription]
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterOptions"><span class="hs-identifier hs-var hs-var">consoleTestReporterOptions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Proxy Quiet -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy v -&gt; OptionDescription
</span><a href="Test.Tasty.Options.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Quiet
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-type">Quiet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy HideSuccesses -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy v -&gt; OptionDescription
</span><a href="Test.Tasty.Options.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy HideSuccesses
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-type">HideSuccesses</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy UseColor -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy v -&gt; OptionDescription
</span><a href="Test.Tasty.Options.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy UseColor
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-type">UseColor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy AnsiTricks -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy v -&gt; OptionDescription
</span><a href="Test.Tasty.Options.html#Option"><span class="hs-identifier hs-var">Option</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy AnsiTricks
forall k (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-type">AnsiTricks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | A simple console UI with a hook to postprocess results,</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- depending on their names and external conditions</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- (e. g., its previous outcome, stored in a file).</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- Names are listed in reverse order:</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- from test's own name to a name of the outermost test group.</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- @since 1.4.2</span><span>
</span><span id="line-447"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterWithHook"><span class="hs-identifier hs-type">consoleTestReporterWithHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Test.Tasty.Core.html#TestName"><span class="hs-identifier hs-type">TestName</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.html#Ingredient"><span class="hs-identifier hs-type">Ingredient</span></a></span><span>
</span><span id="line-448"></span><span id="consoleTestReporterWithHook"><span class="annot"><span class="annottext">consoleTestReporterWithHook :: ([TestName] -&gt; Result -&gt; IO Result) -&gt; Ingredient
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterWithHook"><span class="hs-identifier hs-var hs-var">consoleTestReporterWithHook</span></a></span></span><span> </span><span id="local-6989586621679078079"><span class="annot"><span class="annottext">[TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078079"><span class="hs-identifier hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
-&gt; Ingredient
</span><a href="Test.Tasty.Ingredients.html#TestReporter"><span class="hs-identifier hs-var">TestReporter</span></a></span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleTestReporterOptions"><span class="hs-identifier hs-var">consoleTestReporterOptions</span></a></span><span> </span><span class="annot"><span class="annottext">((OptionSet
  -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
 -&gt; Ingredient)
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
-&gt; Ingredient
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621679078078"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679078077"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StatusMap -&gt; IO (Time -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">((StatusMap -&gt; IO (Time -&gt; IO Bool))
 -&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool)))
-&gt; (StatusMap -&gt; IO (Time -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Time -&gt; IO Bool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078076"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679078075"><span class="annot"><span class="annottext">whenColor :: UseColor
</span><a href="#local-6989586621679078075"><span class="hs-identifier hs-var hs-var">whenColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; UseColor
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-type">Quiet</span></a></span><span> </span><span id="local-6989586621679078073"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078073"><span class="hs-identifier hs-var">quiet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; Quiet
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-type">HideSuccesses</span></a></span><span> </span><span id="local-6989586621679078071"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078071"><span class="hs-identifier hs-var">hideSuccesses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; HideSuccesses
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><a href="Test.Tasty.Options.Core.html#NumThreads"><span class="hs-identifier hs-type">NumThreads</span></a></span><span> </span><span id="local-6989586621679078069"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078069"><span class="hs-identifier hs-var">numThreads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; NumThreads
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-type">AnsiTricks</span></a></span><span> </span><span id="local-6989586621679078067"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078067"><span class="hs-identifier hs-var">ansiTricks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; AnsiTricks
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><a href="Test.Tasty.Options.html#lookupOption"><span class="hs-identifier hs-var">lookupOption</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078073"><span class="hs-identifier hs-var">quiet</span></a></span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-460"></span><span>      </span><span id="local-6989586621679078066"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078066"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; StatusMap -&gt; IO Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statusMapResult"><span class="hs-identifier hs-var">statusMapResult</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078069"><span class="hs-identifier hs-var">numThreads</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><span class="annottext">(Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool))
-&gt; (Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078065"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">_time</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078066"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-keyword">else</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-465"></span><span>      </span><span id="local-6989586621679078064"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078064"><span class="hs-identifier hs-var">isTerm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hSupportsANSI</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-466"></span><span>      </span><span id="local-6989586621679078062"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078062"><span class="hs-identifier hs-var">isTermColor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hSupportsANSIColor</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078060"><span class="annot"><span class="annottext">IO (Time -&gt; IO Bool)
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078064"><span class="hs-identifier hs-var">isTerm</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier hs-var">hideCursor</span></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">IO (Time -&gt; IO Bool)
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO (Time -&gt; IO Bool) -&gt; IO () -&gt; IO (Time -&gt; IO Bool)
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier hs-var">showCursor</span></span><span>
</span><span id="line-470"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO (Time -&gt; IO Bool)
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool))
-&gt; IO (Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier hs-var">LineBuffering</span></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-475"></span><span>            </span><span class="">?colors</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">useColor</span><span> </span><span class="hs-identifier">whenColor</span><span> </span><span class="hs-identifier">isTermColor</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>          </span><span class="hs-keyword">let</span><span>
</span><span id="line-478"></span><span>            </span><span id="local-6989586621679078054"><span class="annot"><span class="annottext">toutput :: TestOutput
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var hs-var">toutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; Result -&gt; IO Result) -&gt; TestOutput -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#applyHook"><span class="hs-identifier hs-var">applyHook</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; Result -&gt; IO Result
</span><a href="#local-6989586621679078079"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">(TestOutput -&gt; TestOutput) -&gt; TestOutput -&gt; TestOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; OptionSet -&gt; TestTree -&gt; TestOutput
OptionSet -&gt; TestTree -&gt; TestOutput
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#buildTestOutput"><span class="hs-identifier hs-var">buildTestOutput</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679078078"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679078077"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-481"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078071"><span class="hs-identifier hs-var">hideSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078064"><span class="hs-identifier hs-var">isTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078067"><span class="hs-identifier hs-var">ansiTricks</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-482"></span><span>                </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestOutput -&gt; StatusMap -&gt; IO ()
TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutputHidingSuccesses"><span class="hs-identifier hs-var">consoleOutputHidingSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-483"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679078071"><span class="hs-identifier hs-var">hideSuccesses</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-484"></span><span>                </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestOutput -&gt; StatusMap -&gt; IO ()
TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#streamOutputHidingSuccesses"><span class="hs-identifier hs-var">streamOutputHidingSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-485"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; TestOutput -&gt; StatusMap -&gt; IO ()
TestOutput -&gt; StatusMap -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#consoleOutput"><span class="hs-identifier hs-var">consoleOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TestOutput
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">toutput</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-486"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span>          </span><span class="annot"><span class="annottext">(Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool))
-&gt; (Time -&gt; IO Bool) -&gt; IO (Time -&gt; IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078052"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078052"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-489"></span><span>            </span><span id="local-6989586621679078051"><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078051"><span class="hs-identifier hs-var">stats</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StatusMap -&gt; IO Statistics
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeStatistics"><span class="hs-identifier hs-var">computeStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679078076"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-490"></span><span>            </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; Statistics -&gt; Time -&gt; IO ()
Statistics -&gt; Time -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#printStatistics"><span class="hs-identifier hs-var">printStatistics</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078051"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679078052"><span class="hs-identifier hs-var">time</span></a></span><span>
</span><span id="line-491"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; IO Bool) -&gt; Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statistics -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#statFailures"><span class="hs-identifier hs-var hs-var">statFailures</span></a></span><span> </span><span class="annot"><span class="annottext">Statistics
</span><a href="#local-6989586621679078051"><span class="hs-identifier hs-var">stats</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | Do not print test results (see README for details)</span><span>
</span><span id="line-494"></span><span class="hs-keyword">newtype</span><span> </span><span id="Quiet"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Quiet"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078047"><span id="local-6989586621679078049"><span class="annot"><span class="annottext">Quiet -&gt; Quiet -&gt; Bool
(Quiet -&gt; Quiet -&gt; Bool) -&gt; (Quiet -&gt; Quiet -&gt; Bool) -&gt; Eq Quiet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Quiet -&gt; Quiet -&gt; Bool
$c/= :: Quiet -&gt; Quiet -&gt; Bool
== :: Quiet -&gt; Quiet -&gt; Bool
$c== :: Quiet -&gt; Quiet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078031"><span id="local-6989586621679078033"><span id="local-6989586621679078035"><span id="local-6989586621679078037"><span id="local-6989586621679078039"><span id="local-6989586621679078041"><span id="local-6989586621679078043"><span class="annot"><span class="annottext">Eq Quiet
Eq Quiet
-&gt; (Quiet -&gt; Quiet -&gt; Ordering)
-&gt; (Quiet -&gt; Quiet -&gt; Bool)
-&gt; (Quiet -&gt; Quiet -&gt; Bool)
-&gt; (Quiet -&gt; Quiet -&gt; Bool)
-&gt; (Quiet -&gt; Quiet -&gt; Bool)
-&gt; (Quiet -&gt; Quiet -&gt; Quiet)
-&gt; (Quiet -&gt; Quiet -&gt; Quiet)
-&gt; Ord Quiet
Quiet -&gt; Quiet -&gt; Bool
Quiet -&gt; Quiet -&gt; Ordering
Quiet -&gt; Quiet -&gt; Quiet
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Quiet -&gt; Quiet -&gt; Quiet
$cmin :: Quiet -&gt; Quiet -&gt; Quiet
max :: Quiet -&gt; Quiet -&gt; Quiet
$cmax :: Quiet -&gt; Quiet -&gt; Quiet
&gt;= :: Quiet -&gt; Quiet -&gt; Bool
$c&gt;= :: Quiet -&gt; Quiet -&gt; Bool
&gt; :: Quiet -&gt; Quiet -&gt; Bool
$c&gt; :: Quiet -&gt; Quiet -&gt; Bool
&lt;= :: Quiet -&gt; Quiet -&gt; Bool
$c&lt;= :: Quiet -&gt; Quiet -&gt; Bool
&lt; :: Quiet -&gt; Quiet -&gt; Bool
$c&lt; :: Quiet -&gt; Quiet -&gt; Bool
compare :: Quiet -&gt; Quiet -&gt; Ordering
$ccompare :: Quiet -&gt; Quiet -&gt; Ordering
$cp1Ord :: Eq Quiet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078023"><span class="annot"><a href="Test.Tasty.Options.html#IsOption"><span class="hs-identifier hs-type">IsOption</span></a></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-type">Quiet</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679078020"><span class="annot"><span class="annottext">defaultValue :: Quiet
</span><a href="Test.Tasty.Options.html#defaultValue"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Quiet
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621679078018"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe Quiet
</span><a href="Test.Tasty.Options.html#parseValue"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Quiet) -&gt; Maybe Bool -&gt; Maybe Quiet
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Quiet
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Maybe Quiet)
-&gt; (TestName -&gt; Maybe Bool) -&gt; TestName -&gt; Maybe Quiet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Bool
</span><a href="Test.Tasty.Options.html#safeReadBool"><span class="hs-identifier hs-var">safeReadBool</span></a></span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679078015"><span class="annot"><span class="annottext">optionName :: Tagged Quiet TestName
</span><a href="Test.Tasty.Options.html#optionName"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged Quiet TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;quiet&quot;</span></span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679078013"><span class="annot"><span class="annottext">optionHelp :: Tagged Quiet TestName
</span><a href="Test.Tasty.Options.html#optionHelp"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged Quiet TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Do not produce any output; indicate success only by the exit code&quot;</span></span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679078011"><span class="annot"><span class="annottext">optionCLParser :: Parser Quiet
</span><a href="Test.Tasty.Options.html#optionCLParser"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionCLParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mod FlagFields Quiet -&gt; Quiet -&gt; Parser Quiet
forall v. IsOption v =&gt; Mod FlagFields v -&gt; v -&gt; Parser v
</span><a href="Test.Tasty.Options.html#mkFlagCLParser"><span class="hs-identifier hs-var">mkFlagCLParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Mod FlagFields Quiet
forall (f :: * -&gt; *) a. HasName f =&gt; Char -&gt; Mod f a
</span><span class="hs-identifier hs-var">short</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'q'</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Quiet
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Quiet"><span class="hs-identifier hs-var">Quiet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="hs-comment">-- | Report only failed tests</span><span>
</span><span id="line-504"></span><span class="hs-keyword">newtype</span><span> </span><span id="HideSuccesses"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-var">HideSuccesses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HideSuccesses"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-var">HideSuccesses</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078004"><span id="local-6989586621679078006"><span class="annot"><span class="annottext">HideSuccesses -&gt; HideSuccesses -&gt; Bool
(HideSuccesses -&gt; HideSuccesses -&gt; Bool)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Bool) -&gt; Eq HideSuccesses
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c/= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
== :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c== :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077989"><span id="local-6989586621679077991"><span id="local-6989586621679077993"><span id="local-6989586621679077995"><span id="local-6989586621679077997"><span id="local-6989586621679077999"><span id="local-6989586621679078001"><span class="annot"><span class="annottext">Eq HideSuccesses
Eq HideSuccesses
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Ordering)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Bool)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Bool)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Bool)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; Bool)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses)
-&gt; (HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses)
-&gt; Ord HideSuccesses
HideSuccesses -&gt; HideSuccesses -&gt; Bool
HideSuccesses -&gt; HideSuccesses -&gt; Ordering
HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses
$cmin :: HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses
max :: HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses
$cmax :: HideSuccesses -&gt; HideSuccesses -&gt; HideSuccesses
&gt;= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c&gt;= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
&gt; :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c&gt; :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
&lt;= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c&lt;= :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
&lt; :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
$c&lt; :: HideSuccesses -&gt; HideSuccesses -&gt; Bool
compare :: HideSuccesses -&gt; HideSuccesses -&gt; Ordering
$ccompare :: HideSuccesses -&gt; HideSuccesses -&gt; Ordering
$cp1Ord :: Eq HideSuccesses
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077982"><span class="annot"><a href="Test.Tasty.Options.html#IsOption"><span class="hs-identifier hs-type">IsOption</span></a></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-type">HideSuccesses</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679077980"><span class="annot"><span class="annottext">defaultValue :: HideSuccesses
</span><a href="#local-6989586621679077980"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HideSuccesses
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-var">HideSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621679077979"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe HideSuccesses
</span><a href="#local-6989586621679077979"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HideSuccesses) -&gt; Maybe Bool -&gt; Maybe HideSuccesses
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HideSuccesses
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-var">HideSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Maybe HideSuccesses)
-&gt; (TestName -&gt; Maybe Bool) -&gt; TestName -&gt; Maybe HideSuccesses
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Bool
</span><a href="Test.Tasty.Options.html#safeReadBool"><span class="hs-identifier hs-var">safeReadBool</span></a></span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621679077978"><span class="annot"><span class="annottext">optionName :: Tagged HideSuccesses TestName
</span><a href="#local-6989586621679077978"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged HideSuccesses TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;hide-successes&quot;</span></span><span>
</span><span id="line-510"></span><span>  </span><span id="local-6989586621679077977"><span class="annot"><span class="annottext">optionHelp :: Tagged HideSuccesses TestName
</span><a href="#local-6989586621679077977"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged HideSuccesses TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Do not print tests that passed successfully&quot;</span></span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679077976"><span class="annot"><span class="annottext">optionCLParser :: Parser HideSuccesses
</span><a href="#local-6989586621679077976"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionCLParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mod FlagFields HideSuccesses
-&gt; HideSuccesses -&gt; Parser HideSuccesses
forall v. IsOption v =&gt; Mod FlagFields v -&gt; v -&gt; Parser v
</span><a href="Test.Tasty.Options.html#mkFlagCLParser"><span class="hs-identifier hs-var">mkFlagCLParser</span></a></span><span> </span><span class="annot"><span class="annottext">Mod FlagFields HideSuccesses
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; HideSuccesses
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#HideSuccesses"><span class="hs-identifier hs-var">HideSuccesses</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">-- | When to use color on the output</span><span>
</span><span id="line-514"></span><span class="hs-comment">--</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-516"></span><span class="hs-keyword">data</span><span> </span><span id="UseColor"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-var">UseColor</span></a></span></span><span>
</span><span id="line-517"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Never"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Never"><span class="hs-identifier hs-var">Never</span></a></span></span><span>
</span><span id="line-518"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Always"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Always"><span class="hs-identifier hs-var">Always</span></a></span></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Auto"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Auto"><span class="hs-identifier hs-var">Auto</span></a></span></span><span> </span><span class="hs-comment">-- ^ Only if stdout is an ANSI color supporting terminal</span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077969"><span id="local-6989586621679077971"><span class="annot"><span class="annottext">UseColor -&gt; UseColor -&gt; Bool
(UseColor -&gt; UseColor -&gt; Bool)
-&gt; (UseColor -&gt; UseColor -&gt; Bool) -&gt; Eq UseColor
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: UseColor -&gt; UseColor -&gt; Bool
$c/= :: UseColor -&gt; UseColor -&gt; Bool
== :: UseColor -&gt; UseColor -&gt; Bool
$c== :: UseColor -&gt; UseColor -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077954"><span id="local-6989586621679077956"><span id="local-6989586621679077958"><span id="local-6989586621679077960"><span id="local-6989586621679077962"><span id="local-6989586621679077964"><span id="local-6989586621679077966"><span class="annot"><span class="annottext">Eq UseColor
Eq UseColor
-&gt; (UseColor -&gt; UseColor -&gt; Ordering)
-&gt; (UseColor -&gt; UseColor -&gt; Bool)
-&gt; (UseColor -&gt; UseColor -&gt; Bool)
-&gt; (UseColor -&gt; UseColor -&gt; Bool)
-&gt; (UseColor -&gt; UseColor -&gt; Bool)
-&gt; (UseColor -&gt; UseColor -&gt; UseColor)
-&gt; (UseColor -&gt; UseColor -&gt; UseColor)
-&gt; Ord UseColor
UseColor -&gt; UseColor -&gt; Bool
UseColor -&gt; UseColor -&gt; Ordering
UseColor -&gt; UseColor -&gt; UseColor
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: UseColor -&gt; UseColor -&gt; UseColor
$cmin :: UseColor -&gt; UseColor -&gt; UseColor
max :: UseColor -&gt; UseColor -&gt; UseColor
$cmax :: UseColor -&gt; UseColor -&gt; UseColor
&gt;= :: UseColor -&gt; UseColor -&gt; Bool
$c&gt;= :: UseColor -&gt; UseColor -&gt; Bool
&gt; :: UseColor -&gt; UseColor -&gt; Bool
$c&gt; :: UseColor -&gt; UseColor -&gt; Bool
&lt;= :: UseColor -&gt; UseColor -&gt; Bool
$c&lt;= :: UseColor -&gt; UseColor -&gt; Bool
&lt; :: UseColor -&gt; UseColor -&gt; Bool
$c&lt; :: UseColor -&gt; UseColor -&gt; Bool
compare :: UseColor -&gt; UseColor -&gt; Ordering
$ccompare :: UseColor -&gt; UseColor -&gt; Ordering
$cp1Ord :: Eq UseColor
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-comment">-- | Control color output</span><span>
</span><span id="line-523"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html#IsOption"><span class="hs-identifier hs-type">IsOption</span></a></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-type">UseColor</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-524"></span><span>  </span><span id="local-6989586621679077946"><span class="annot"><span class="annottext">defaultValue :: UseColor
</span><a href="#local-6989586621679077946"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Auto"><span class="hs-identifier hs-var">Auto</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span id="local-6989586621679077945"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe UseColor
</span><a href="#local-6989586621679077945"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#parseUseColor"><span class="hs-identifier hs-var">parseUseColor</span></a></span><span>
</span><span id="line-526"></span><span>  </span><span id="local-6989586621679077943"><span class="annot"><span class="annottext">optionName :: Tagged UseColor TestName
</span><a href="#local-6989586621679077943"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged UseColor TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;color&quot;</span></span><span>
</span><span id="line-527"></span><span>  </span><span id="local-6989586621679077942"><span class="annot"><span class="annottext">optionHelp :: Tagged UseColor TestName
</span><a href="#local-6989586621679077942"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged UseColor TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;When to use colored output&quot;</span></span><span>
</span><span id="line-528"></span><span>  </span><span id="local-6989586621679077941"><span class="annot"><span class="annottext">optionCLParser :: Parser UseColor
</span><a href="#local-6989586621679077941"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionCLParser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mod OptionFields UseColor -&gt; Parser UseColor
forall v. IsOption v =&gt; Mod OptionFields v -&gt; Parser v
</span><a href="Test.Tasty.Options.html#mkOptionCLParser"><span class="hs-identifier hs-var">mkOptionCLParser</span></a></span><span> </span><span class="annot"><span class="annottext">(Mod OptionFields UseColor -&gt; Parser UseColor)
-&gt; Mod OptionFields UseColor -&gt; Parser UseColor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Mod OptionFields UseColor
forall (f :: * -&gt; *) a. HasMetavar f =&gt; TestName -&gt; Mod f a
</span><span class="hs-identifier hs-var">metavar</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;never|always|auto&quot;</span></span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679077938"><span class="annot"><span class="annottext">showDefaultValue :: UseColor -&gt; Maybe TestName
</span><a href="Test.Tasty.Options.html#showDefaultValue"><span class="hs-identifier hs-var hs-var hs-var hs-var">showDefaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe TestName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Maybe TestName)
-&gt; (UseColor -&gt; TestName) -&gt; UseColor -&gt; Maybe TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UseColor -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayUseColor"><span class="hs-identifier hs-var">displayUseColor</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- | By default, when the option @--hide-successes@ is given and the output</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- goes to an ANSI-capable terminal, we employ some ANSI terminal tricks to</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- display the name of the currently running test and then erase it if it</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- succeeds.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- These tricks sometimes fail, however&#8212;in particular, when the test names</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- happen to be longer than the width of the terminal window. See</span><span>
</span><span id="line-538"></span><span class="hs-comment">--</span><span>
</span><span id="line-539"></span><span class="hs-comment">-- * &lt;https://github.com/UnkindPartition/tasty/issues/152&gt;</span><span>
</span><span id="line-540"></span><span class="hs-comment">--</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- * &lt;https://github.com/UnkindPartition/tasty/issues/250&gt;</span><span>
</span><span id="line-542"></span><span class="hs-comment">--</span><span>
</span><span id="line-543"></span><span class="hs-comment">-- When that happens, this option can be used to disable the tricks. In</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- that case, the test name will be printed only once the test fails.</span><span>
</span><span id="line-545"></span><span class="hs-keyword">newtype</span><span> </span><span id="AnsiTricks"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-var">AnsiTricks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnsiTricks"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-var">AnsiTricks</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getAnsiTricks"><span class="annot"><span class="annottext">AnsiTricks -&gt; Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getAnsiTricks"><span class="hs-identifier hs-var hs-var">getAnsiTricks</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077927"><span class="annot"><a href="Test.Tasty.Options.html#IsOption"><span class="hs-identifier hs-type">IsOption</span></a></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-type">AnsiTricks</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>  </span><span id="local-6989586621679077926"><span class="annot"><span class="annottext">defaultValue :: AnsiTricks
</span><a href="#local-6989586621679077926"><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; AnsiTricks
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-var">AnsiTricks</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-550"></span><span>  </span><span id="local-6989586621679077925"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe AnsiTricks
</span><a href="#local-6989586621679077925"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; AnsiTricks) -&gt; Maybe Bool -&gt; Maybe AnsiTricks
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; AnsiTricks
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#AnsiTricks"><span class="hs-identifier hs-var">AnsiTricks</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Maybe AnsiTricks)
-&gt; (TestName -&gt; Maybe Bool) -&gt; TestName -&gt; Maybe AnsiTricks
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Bool
</span><a href="Test.Tasty.Options.html#safeReadBool"><span class="hs-identifier hs-var">safeReadBool</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span id="local-6989586621679077924"><span class="annot"><span class="annottext">optionName :: Tagged AnsiTricks TestName
</span><a href="#local-6989586621679077924"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged AnsiTricks TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;ansi-tricks&quot;</span></span><span>
</span><span id="line-552"></span><span>  </span><span id="local-6989586621679077923"><span class="annot"><span class="annottext">optionHelp :: Tagged AnsiTricks TestName
</span><a href="#local-6989586621679077923"><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged AnsiTricks TestName
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Tagged AnsiTricks TestName)
-&gt; TestName -&gt; Tagged AnsiTricks TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-comment">-- Multiline literals don't work because of -XCPP.</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Enable various ANSI terminal tricks. &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Can be set to 'true' or 'false'.&quot;</span></span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621679077922"><span class="annot"><span class="annottext">showDefaultValue :: AnsiTricks -&gt; Maybe TestName
</span><a href="#local-6989586621679077922"><span class="hs-identifier hs-var hs-var hs-var hs-var">showDefaultValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe TestName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Maybe TestName)
-&gt; (AnsiTricks -&gt; TestName) -&gt; AnsiTricks -&gt; Maybe TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayBool"><span class="hs-identifier hs-var">displayBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; TestName)
-&gt; (AnsiTricks -&gt; Bool) -&gt; AnsiTricks -&gt; TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AnsiTricks -&gt; Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getAnsiTricks"><span class="hs-identifier hs-var hs-var">getAnsiTricks</span></a></span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayBool"><span class="hs-identifier hs-type">displayBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-559"></span><span id="displayBool"><span class="annot"><span class="annottext">displayBool :: Bool -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayBool"><span class="hs-identifier hs-var hs-var">displayBool</span></a></span></span><span> </span><span id="local-6989586621679077920"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077920"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077920"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;false&quot;</span></span><span>
</span><span id="line-562"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;true&quot;</span></span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | @useColor when isTerm@ decides if colors should be used,</span><span>
</span><span id="line-565"></span><span class="hs-comment">--   where @isTerm@ indicates whether @stdout@ is a terminal device.</span><span>
</span><span id="line-566"></span><span class="hs-comment">--</span><span>
</span><span id="line-567"></span><span class="hs-comment">--   @since 0.11.3</span><span>
</span><span id="line-568"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#useColor"><span class="hs-identifier hs-type">useColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-type">UseColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-569"></span><span id="useColor"><span class="annot"><span class="annottext">useColor :: UseColor -&gt; Bool -&gt; Bool
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#useColor"><span class="hs-identifier hs-var hs-var">useColor</span></a></span></span><span> </span><span id="local-6989586621679077919"><span class="annot"><span class="annottext">UseColor
</span><a href="#local-6989586621679077919"><span class="hs-identifier hs-var">when_</span></a></span></span><span> </span><span id="local-6989586621679077918"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077918"><span class="hs-identifier hs-var">isTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="#local-6989586621679077919"><span class="hs-identifier hs-var">when_</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Never"><span class="hs-identifier hs-var">Never</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Always"><span class="hs-identifier hs-var">Always</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Auto"><span class="hs-identifier hs-var">Auto</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077918"><span class="hs-identifier hs-var">isTerm</span></a></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#parseUseColor"><span class="hs-identifier hs-type">parseUseColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-type">UseColor</span></a></span><span>
</span><span id="line-576"></span><span id="parseUseColor"><span class="annot"><span class="annottext">parseUseColor :: TestName -&gt; Maybe UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#parseUseColor"><span class="hs-identifier hs-var hs-var">parseUseColor</span></a></span></span><span> </span><span id="local-6989586621679077917"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077917"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; TestName -&gt; TestName
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077917"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;never&quot;</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UseColor -&gt; Maybe UseColor
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Never"><span class="hs-identifier hs-var">Never</span></a></span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;always&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UseColor -&gt; Maybe UseColor
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Always"><span class="hs-identifier hs-var">Always</span></a></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;auto&quot;</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UseColor -&gt; Maybe UseColor
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Auto"><span class="hs-identifier hs-var">Auto</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe UseColor
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-582"></span><span>
</span><span id="line-583"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayUseColor"><span class="hs-identifier hs-type">displayUseColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#UseColor"><span class="hs-identifier hs-type">UseColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-584"></span><span id="displayUseColor"><span class="annot"><span class="annottext">displayUseColor :: UseColor -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#displayUseColor"><span class="hs-identifier hs-var hs-var">displayUseColor</span></a></span></span><span> </span><span id="local-6989586621679077915"><span class="annot"><span class="annottext">UseColor
</span><a href="#local-6989586621679077915"><span class="hs-identifier hs-var">uc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-585"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">UseColor
</span><a href="#local-6989586621679077915"><span class="hs-identifier hs-var">uc</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-586"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Never"><span class="hs-identifier hs-var">Never</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;never&quot;</span></span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Always"><span class="hs-identifier hs-var">Always</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;always&quot;</span></span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><span class="annottext">UseColor
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Auto"><span class="hs-identifier hs-var">Auto</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;auto&quot;</span></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- Various utilities</span><span>
</span><span id="line-594"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-596"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getResultFromTVar"><span class="hs-identifier hs-type">getResultFromTVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TVar</span></span><span> </span><span class="annot"><a href="Test.Tasty.Run.html#Status"><span class="hs-identifier hs-type">Status</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#Result"><span class="hs-identifier hs-type">Result</span></a></span><span>
</span><span id="line-597"></span><span id="getResultFromTVar"><span class="annot"><span class="annottext">getResultFromTVar :: TVar Status -&gt; IO Result
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#getResultFromTVar"><span class="hs-identifier hs-var hs-var">getResultFromTVar</span></a></span></span><span> </span><span id="local-6989586621679077914"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679077914"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-598"></span><span>  </span><span class="annot"><span class="annottext">STM Result -&gt; IO Result
forall a. STM a -&gt; IO a
</span><span class="hs-identifier hs-var">atomically</span></span><span> </span><span class="annot"><span class="annottext">(STM Result -&gt; IO Result) -&gt; STM Result -&gt; IO Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-599"></span><span>    </span><span id="local-6989586621679077913"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679077913"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><span class="hs-identifier hs-var">readTVar</span></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679077914"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679077913"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><a href="Test.Tasty.Run.html#Done"><span class="hs-identifier hs-type">Done</span></a></span><span> </span><span id="local-6989586621679077912"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679077912"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; STM Result
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679077912"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">STM Result
forall a. STM a
</span><span class="hs-identifier hs-var">retry</span></span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- Formatting</span><span>
</span><span id="line-608"></span><span class="hs-comment">--------------------------------------------------</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- {{{</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indentSize"><span class="hs-identifier hs-type">indentSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-612"></span><span id="indentSize"><span class="annot"><span class="annottext">indentSize :: Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indentSize"><span class="hs-identifier hs-var hs-var">indentSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-type">indent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-615"></span><span id="indent"><span class="annot"><span class="annottext">indent :: Int -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679077911"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077911"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; TestName
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indentSize"><span class="hs-identifier hs-var">indentSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077911"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span class="hs-comment">-- handle multi-line result descriptions properly</span><span>
</span><span id="line-618"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#formatDesc"><span class="hs-identifier hs-type">formatDesc</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- indent</span><span>
</span><span id="line-620"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-622"></span><span id="formatDesc"><span class="annot"><span class="annottext">formatDesc :: Int -&gt; TestName -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#formatDesc"><span class="hs-identifier hs-var hs-var">formatDesc</span></a></span></span><span> </span><span id="local-6989586621679077910"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077910"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679077909"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077909"><span class="hs-identifier hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-623"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-624"></span><span>    </span><span class="hs-comment">-- remove all trailing linebreaks</span><span>
</span><span id="line-625"></span><span>    </span><span id="local-6989586621679077908"><span class="annot"><span class="annottext">chomped :: TestName
</span><a href="#local-6989586621679077908"><span class="hs-identifier hs-var hs-var">chomped</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; TestName)
-&gt; (TestName -&gt; TestName) -&gt; TestName -&gt; TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; TestName -&gt; TestName
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; TestName)
-&gt; (TestName -&gt; TestName) -&gt; TestName -&gt; TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; TestName) -&gt; TestName -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077909"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span>    </span><span id="local-6989586621679077906"><span class="annot"><span class="annottext">multiline :: Bool
</span><a href="#local-6989586621679077906"><span class="hs-identifier hs-var hs-var">multiline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077908"><span class="hs-identifier hs-var">chomped</span></a></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-comment">-- we add a leading linebreak to the description, to start it on a new</span><span>
</span><span id="line-630"></span><span>    </span><span class="hs-comment">-- line and add an indentation</span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621679077904"><span class="annot"><span class="annottext">paddedDesc :: TestName
</span><a href="#local-6989586621679077904"><span class="hs-identifier hs-var hs-var">paddedDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Char -&gt; TestName) -&gt; TestName -&gt; TestName)
-&gt; TestName -&gt; (Char -&gt; TestName) -&gt; TestName
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; TestName) -&gt; TestName -&gt; TestName
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077908"><span class="hs-identifier hs-var">chomped</span></a></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; TestName) -&gt; TestName) -&gt; (Char -&gt; TestName) -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679077903"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077903"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-632"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077903"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077903"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; TestName
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077910"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-634"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077903"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>  </span><span class="hs-keyword">in</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679077906"><span class="hs-identifier hs-var">multiline</span></a></span><span>
</span><span id="line-637"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077904"><span class="hs-identifier hs-var">paddedDesc</span></a></span><span>
</span><span id="line-638"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077908"><span class="hs-identifier hs-var">chomped</span></a></span><span>
</span><span id="line-639"></span><span>
</span><span id="line-640"></span><span class="hs-keyword">data</span><span> </span><span id="Maximum"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span></span><span> </span><span id="local-6989586621679078388"><span class="annot"><a href="#local-6989586621679078388"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Maximum"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679078388"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MinusInfinity"><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#MinusInfinity"><span class="hs-identifier hs-var">MinusInfinity</span></a></span></span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span id="local-6989586621679077900"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077895"><span id="local-6989586621679077897"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679077900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Sem.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span id="local-6989586621679077894"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077894"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679077893"><span class="annot"><span class="annottext">&lt;&gt; :: Maximum a -&gt; Maximum a -&gt; Maximum a
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span id="local-6989586621679077892"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077892"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maximum a
forall a. a -&gt; Maximum a
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077894"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`max`</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077892"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>  </span><span class="annot"><span class="annottext">Maximum a
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#MinusInfinity"><span class="hs-identifier hs-var">MinusInfinity</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679077890"><span class="annot"><span class="annottext">Maximum a
</span><a href="#local-6989586621679077890"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maximum a
</span><a href="#local-6989586621679077890"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-647"></span><span>  </span><span id="local-6989586621679077889"><span class="annot"><span class="annottext">Maximum a
</span><a href="#local-6989586621679077889"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maximum a
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#MinusInfinity"><span class="hs-identifier hs-var">MinusInfinity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maximum a
</span><a href="#local-6989586621679077889"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-648"></span><span id="local-6989586621679077888"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679077882"><span id="local-6989586621679077884"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679077888"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679077888"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621679077881"><span class="annot"><span class="annottext">mempty :: Maximum a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maximum a
forall a. Maximum a
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#MinusInfinity"><span class="hs-identifier hs-var">MinusInfinity</span></a></span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4,11,0)
</span><span>  </span><span class="hs-identifier">mappend</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator">Sem.&lt;&gt;</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-654"></span><span class="hs-comment">-- | Compute the amount of space needed to align \&quot;OK\&quot;s and \&quot;FAIL\&quot;s</span><span>
</span><span id="line-655"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeAlignment"><span class="hs-identifier hs-type">computeAlignment</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Test.Tasty.Options.html#OptionSet"><span class="hs-identifier hs-type">OptionSet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Core.html#TestTree"><span class="hs-identifier hs-type">TestTree</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-656"></span><span id="computeAlignment"><span class="annot"><span class="annottext">computeAlignment :: OptionSet -&gt; TestTree -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#computeAlignment"><span class="hs-identifier hs-var hs-var">computeAlignment</span></a></span></span><span> </span><span id="local-6989586621679077880"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679077880"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-657"></span><span>  </span><span class="annot"><span class="annottext">(Int -&gt; Maximum Int) -&gt; Int
forall t p. (Num t, Num p) =&gt; (t -&gt; Maximum p) -&gt; p
</span><a href="#local-6989586621679077879"><span class="hs-identifier hs-var">fromMonoid</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Maximum Int) -&gt; Int)
-&gt; (TestTree -&gt; Int -&gt; Maximum Int) -&gt; TestTree -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>
</span><span id="line-658"></span><span>  </span><span class="annot"><span class="annottext">TreeFold (Int -&gt; Maximum Int)
-&gt; OptionSet -&gt; TestTree -&gt; Int -&gt; Maximum Int
forall b. Monoid b =&gt; TreeFold b -&gt; OptionSet -&gt; TestTree -&gt; b
</span><a href="Test.Tasty.Core.html#foldTestTree"><span class="hs-identifier hs-var">foldTestTree</span></a></span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><span class="annottext">TreeFold (Int -&gt; Maximum Int)
forall b. Monoid b =&gt; TreeFold b
</span><a href="Test.Tasty.Core.html#trivialFold"><span class="hs-identifier hs-var">trivialFold</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">foldSingle :: forall t.
IsTest t =&gt;
OptionSet -&gt; TestName -&gt; t -&gt; Int -&gt; Maximum Int
</span><a href="Test.Tasty.Core.html#foldSingle"><span class="hs-identifier hs-var">foldSingle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">OptionSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679077878"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077878"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679077877"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077877"><span class="hs-identifier hs-var">level</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maximum Int
forall a. a -&gt; Maximum a
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-var">Maximum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#stringWidth"><span class="hs-identifier hs-var">stringWidth</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679077878"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077877"><span class="hs-identifier hs-var">level</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">foldGroup :: OptionSet -&gt; TestName -&gt; (Int -&gt; Maximum Int) -&gt; Int -&gt; Maximum Int
</span><a href="Test.Tasty.Core.html#foldGroup"><span class="hs-identifier hs-var">foldGroup</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679077876"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679077876"><span class="hs-identifier hs-var">_opts</span></a></span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679077875"><span class="annot"><span class="annottext">Int -&gt; Maximum Int
</span><a href="#local-6989586621679077875"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maximum Int
</span><a href="#local-6989586621679077875"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maximum Int) -&gt; (Int -&gt; Int) -&gt; Int -&gt; Maximum Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#indentSize"><span class="hs-identifier hs-var">indentSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679077880"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621679077879"><span class="annot"><span class="annottext">fromMonoid :: (t -&gt; Maximum p) -&gt; p
</span><a href="#local-6989586621679077879"><span class="hs-identifier hs-var hs-var">fromMonoid</span></a></span></span><span> </span><span id="local-6989586621679077874"><span class="annot"><span class="annottext">t -&gt; Maximum p
</span><a href="#local-6989586621679077874"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-666"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; Maximum p
</span><a href="#local-6989586621679077874"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-667"></span><span>        </span><span class="annot"><span class="annottext">Maximum p
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#MinusInfinity"><span class="hs-identifier hs-var">MinusInfinity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span>
</span><span id="line-668"></span><span>        </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#Maximum"><span class="hs-identifier hs-type">Maximum</span></a></span><span> </span><span id="local-6989586621679077873"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679077873"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679077873"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="hs-comment">-- | Compute the length/width of the string as it would appear in a monospace</span><span>
</span><span id="line-671"></span><span class="hs-comment">--   terminal. This takes into account that even in a &#8220;mono&#8221;space font, not</span><span>
</span><span id="line-672"></span><span class="hs-comment">--   all characters actually have the same width, in particular, most CJK</span><span>
</span><span id="line-673"></span><span class="hs-comment">--   characters have twice the same as Western characters.</span><span>
</span><span id="line-674"></span><span class="hs-comment">--</span><span>
</span><span id="line-675"></span><span class="hs-comment">--   (This only works properly on Unix at the moment; on Windows, the function</span><span>
</span><span id="line-676"></span><span class="hs-comment">--   treats every character as width-1 like 'Data.List.length' does.)</span><span>
</span><span id="line-677"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#stringWidth"><span class="hs-identifier hs-type">stringWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-cpp">
#ifdef VERSION_wcwidth
</span><span id="stringWidth"><span class="annot"><span class="annottext">stringWidth :: TestName -&gt; Int
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#stringWidth"><span class="hs-identifier hs-var hs-var">stringWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">Prelude.sum</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; (TestName -&gt; [Int]) -&gt; TestName -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; TestName -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="#local-6989586621679077871"><span class="hs-identifier hs-var">charWidth</span></a></span><span>
</span><span id="line-680"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077871"><span class="annot"><span class="annottext">charWidth :: Char -&gt; Int
</span><a href="#local-6989586621679077871"><span class="hs-identifier hs-var hs-var">charWidth</span></a></span></span><span> </span><span id="local-6989586621679077870"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">wcwidth</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077870"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="hs-comment">-- many chars have &quot;undefined&quot; width; default to 1 for these.</span><span>
</span><span id="line-682"></span><span>        </span><span id="local-6989586621679077869"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077869"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077869"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-cpp">
#else
</span><span class="hs-identifier">stringWidth</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">length</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-687"></span><span class="hs-comment">-- (Potentially) colorful output</span><span>
</span><span id="line-688"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#ok"><span class="hs-identifier hs-type">ok</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#fail"><span class="hs-identifier hs-type">fail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#skipped"><span class="hs-identifier hs-type">skipped</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoOk"><span class="hs-identifier hs-type">infoOk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoFail"><span class="hs-identifier hs-type">infoFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span id="fail"><span class="annot"><span class="annottext">fail :: TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#fail"><span class="hs-identifier hs-var hs-var">fail</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormat -&gt; TestName -&gt; IO ()
ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#failFormat"><span class="hs-identifier hs-var">failFormat</span></a></span><span>
</span><span id="line-690"></span><span id="ok"><span class="annot"><span class="annottext">ok :: TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#ok"><span class="hs-identifier hs-var hs-var">ok</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormat -&gt; TestName -&gt; IO ()
ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#okFormat"><span class="hs-identifier hs-var">okFormat</span></a></span><span>
</span><span id="line-691"></span><span id="skipped"><span class="annot"><span class="annottext">skipped :: TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#skipped"><span class="hs-identifier hs-var hs-var">skipped</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormat -&gt; TestName -&gt; IO ()
ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#skippedFormat"><span class="hs-identifier hs-var">skippedFormat</span></a></span><span>
</span><span id="line-692"></span><span id="infoOk"><span class="annot"><span class="annottext">infoOk :: TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoOk"><span class="hs-identifier hs-var hs-var">infoOk</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormat -&gt; TestName -&gt; IO ()
ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#infoOkFormat"><span class="hs-identifier hs-var">infoOkFormat</span></a></span><span>
</span><span id="line-693"></span><span id="infoFail"><span class="annot"><span class="annottext">infoFail :: TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#infoFail"><span class="hs-identifier hs-var hs-var">infoFail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormat -&gt; TestName -&gt; IO ()
ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#infoFailFormat"><span class="hs-identifier hs-var">infoFailFormat</span></a></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Providers.ConsoleFormat.html#ConsoleFormat"><span class="hs-identifier hs-type">ConsoleFormat</span></a></span><span>
</span><span id="line-698"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-699"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-700"></span><span id="output"><span class="annot"><span class="annottext">output :: ConsoleFormat -&gt; TestName -&gt; IO ()
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#output"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span id="local-6989586621679077862"><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077862"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(?colors::Bool) =&gt; ConsoleFormatPrinter
ConsoleFormatPrinter
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#withConsoleFormat"><span class="hs-identifier hs-var">withConsoleFormat</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077862"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; (TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO ()
</span><span class="hs-identifier hs-var">putStr</span></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | Run action with console configured for a specific output format</span><span>
</span><span id="line-703"></span><span class="hs-comment">--</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- This function does not apply any output formats if colors are disabled at command</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- line or console detection.</span><span>
</span><span id="line-706"></span><span class="hs-comment">--</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- Can be used by providers that wish to provider specific result details printing,</span><span>
</span><span id="line-708"></span><span class="hs-comment">-- while re-using the tasty formats and coloring logic.</span><span>
</span><span id="line-709"></span><span class="hs-comment">--</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- @since 1.3.1</span><span>
</span><span id="line-711"></span><span class="annot"><a href="Test.Tasty.Ingredients.ConsoleReporter.html#withConsoleFormat"><span class="hs-identifier hs-type">withConsoleFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="">?colors</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Test.Tasty.Providers.ConsoleFormat.html#ConsoleFormatPrinter"><span class="hs-identifier hs-type">ConsoleFormatPrinter</span></a></span><span>
</span><span id="line-712"></span><span id="withConsoleFormat"><span class="annot"><span class="annottext">withConsoleFormat :: ConsoleFormatPrinter
</span><a href="Test.Tasty.Ingredients.ConsoleReporter.html#withConsoleFormat"><span class="hs-identifier hs-var hs-var">withConsoleFormat</span></a></span></span><span> </span><span id="local-6989586621679077860"><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679077859"><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679077859"><span class="hs-identifier hs-var">action</span></a></span></span><span>
</span><span id="line-713"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">?colors::Bool
Bool
</span><a href="#local-6989586621679077858"><span class="hs-var">?colors</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-714"></span><span>    </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span>
</span><span id="line-715"></span><span>      </span><span class="annot"><span class="annottext">[SGR] -&gt; IO ()
</span><span class="hs-identifier hs-var">setSGR</span></span><span>
</span><span id="line-716"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ConsoleLayer -&gt; ColorIntensity -&gt; Color -&gt; SGR
</span><span class="hs-identifier hs-var">SetColor</span></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><span class="hs-identifier hs-var">Foreground</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsoleFormat -&gt; ColorIntensity
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#colorIntensity"><span class="hs-identifier hs-var hs-var">colorIntensity</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsoleFormat -&gt; Color
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#color"><span class="hs-identifier hs-var hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConsoleIntensity -&gt; SGR
</span><span class="hs-identifier hs-var">SetConsoleIntensity</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConsoleFormat -&gt; ConsoleIntensity
</span><a href="Test.Tasty.Providers.ConsoleFormat.html#consoleIntensity"><span class="hs-identifier hs-var hs-var">consoleIntensity</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleFormat
</span><a href="#local-6989586621679077860"><span class="hs-identifier hs-var">format</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-719"></span><span>      </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679077859"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO () -&gt; IO ()
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="annot"><span class="annottext">[SGR] -&gt; IO ()
</span><span class="hs-identifier hs-var">setSGR</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679077859"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-724"></span></pre></body></html>