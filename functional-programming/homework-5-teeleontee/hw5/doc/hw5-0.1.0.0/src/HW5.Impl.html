<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">HW5.Impl</span><span> </span><span>
</span><span id="line-2"></span><span class="hs-special">(</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiLength"><span class="hs-identifier">hiLength</span></a></span><span>
</span><span id="line-3"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiCount"><span class="hs-identifier">hiCount</span></a></span><span>
</span><span id="line-4"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier">hiAdd</span></a></span><span>
</span><span id="line-5"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiSub"><span class="hs-identifier">hiSub</span></a></span><span>
</span><span id="line-6"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiMul"><span class="hs-identifier">hiMul</span></a></span><span>
</span><span id="line-7"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier">hiDiv</span></a></span><span>
</span><span id="line-8"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiLT"><span class="hs-identifier">hiLT</span></a></span><span>
</span><span id="line-9"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiGT"><span class="hs-identifier">hiGT</span></a></span><span>
</span><span id="line-10"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiNLT"><span class="hs-identifier">hiNLT</span></a></span><span>
</span><span id="line-11"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiNGT"><span class="hs-identifier">hiNGT</span></a></span><span>
</span><span id="line-12"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiEQ"><span class="hs-identifier">hiEQ</span></a></span><span>
</span><span id="line-13"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiNEQ"><span class="hs-identifier">hiNEQ</span></a></span><span>
</span><span id="line-14"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiRange"><span class="hs-identifier">hiRange</span></a></span><span>
</span><span id="line-15"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiWrite"><span class="hs-identifier">hiWrite</span></a></span><span>
</span><span id="line-16"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiNot"><span class="hs-identifier">hiNot</span></a></span><span>
</span><span id="line-17"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiReverse"><span class="hs-identifier">hiReverse</span></a></span><span>
</span><span id="line-18"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiPackBytes"><span class="hs-identifier">hiPackBytes</span></a></span><span>
</span><span id="line-19"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiUnpackBytes"><span class="hs-identifier">hiUnpackBytes</span></a></span><span>
</span><span id="line-20"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiEncodeUtf8"><span class="hs-identifier">hiEncodeUtf8</span></a></span><span>
</span><span id="line-21"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiDecodeUtf8"><span class="hs-identifier">hiDecodeUtf8</span></a></span><span>
</span><span id="line-22"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiZip"><span class="hs-identifier">hiZip</span></a></span><span>
</span><span id="line-23"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiUnzip"><span class="hs-identifier">hiUnzip</span></a></span><span>
</span><span id="line-24"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiSerialise"><span class="hs-identifier">hiSerialise</span></a></span><span>
</span><span id="line-25"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiDeserialise"><span class="hs-identifier">hiDeserialise</span></a></span><span>
</span><span id="line-26"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiRead"><span class="hs-identifier">hiRead</span></a></span><span>
</span><span id="line-27"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiMkdir"><span class="hs-identifier">hiMkdir</span></a></span><span>
</span><span id="line-28"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiCd"><span class="hs-identifier">hiCd</span></a></span><span>
</span><span id="line-29"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiEcho"><span class="hs-identifier">hiEcho</span></a></span><span>
</span><span id="line-30"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiRandom"><span class="hs-identifier">hiRandom</span></a></span><span>
</span><span id="line-31"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiTimeValue"><span class="hs-identifier">hiTimeValue</span></a></span><span>
</span><span id="line-32"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiKeys"><span class="hs-identifier">hiKeys</span></a></span><span>
</span><span id="line-33"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiValues"><span class="hs-identifier">hiValues</span></a></span><span>
</span><span id="line-34"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiInvert"><span class="hs-identifier">hiInvert</span></a></span><span>
</span><span id="line-35"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiToLower"><span class="hs-identifier">hiToLower</span></a></span><span>
</span><span id="line-36"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiToUpper"><span class="hs-identifier">hiToUpper</span></a></span><span>
</span><span id="line-37"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiTrim"><span class="hs-identifier">hiTrim</span></a></span><span>
</span><span id="line-38"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#foldl1M"><span class="hs-identifier">foldl1M</span></a></span><span>
</span><span id="line-39"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier">hiSlice</span></a></span><span>
</span><span id="line-40"></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier">hiIndex</span></a></span><span>
</span><span id="line-41"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="HW5.Base.html"><span class="hs-identifier">HW5.Base</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stimes</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span> </span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Lazy</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Compression.Zlib</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Serialise</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">showHex</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readHex</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Returns the length of a list or a string</span><span>
</span><span id="line-71"></span><span id="local-6989586621679093209"><span class="annot"><a href="HW5.Impl.html#hiLength"><span class="hs-identifier hs-type">hiLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093209"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093209"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-72"></span><span id="hiLength"><span class="annot"><span class="annottext">hiLength :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiLength"><span class="hs-identifier hs-var hs-var">hiLength</span></a></span></span><span> </span><span id="local-6989586621679093208"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093208"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679093207"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093207"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *). HiMonad m =&gt; HiValue -&gt; ExceptT HiError m Int
</span><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093208"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093207"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Implementation for the count function, calls countString</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- or countList or countByteString depending on the argument</span><span>
</span><span id="line-78"></span><span id="local-6989586621679093204"><span class="annot"><a href="HW5.Impl.html#hiCount"><span class="hs-identifier hs-type">hiCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-79"></span><span id="hiCount"><span class="annot"><span class="annottext">hiCount :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiCount"><span class="hs-identifier hs-var hs-var">hiCount</span></a></span></span><span> </span><span id="local-6989586621679093203"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093203"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093203"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093201"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093201"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
Text -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countString"><span class="hs-identifier hs-var">countString</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093201"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093198"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093198"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
Seq HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countList"><span class="hs-identifier hs-var">countList</span></a></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093198"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093195"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093195"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
ByteString -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countByteString"><span class="hs-identifier hs-var">countByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093195"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679093193"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093193"><span class="hs-identifier hs-var">_otherValue</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | HiFunAdd implementation</span><span>
</span><span id="line-86"></span><span id="local-6989586621679093190"><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-type">hiAdd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-87"></span><span id="hiAdd"><span class="annot"><span class="annottext">hiAdd :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var hs-var">hiAdd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093189"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093189"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093188"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093188"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BinOp ByteString
</span><a href="HW5.Impl.html#concatBytes"><span class="hs-identifier hs-var">concatBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093189"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093188"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-88"></span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var">hiAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093186"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093186"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093185"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093185"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.append</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093186"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093185"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-89"></span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var">hiAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueTime"><span class="hs-identifier hs-type">HiValueTime</span></a></span><span> </span><span id="local-6989586621679093182"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093182"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093181"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093181"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; HiValue
</span><a href="HW5.Base.html#HiValueTime"><span class="hs-identifier hs-var">HiValueTime</span></a></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; HiValue) -&gt; UTCTime -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; NominalDiffTime
forall a. Fractional a =&gt; Rational -&gt; a
</span><span class="hs-identifier hs-var">fromRational</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093181"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093182"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-90"></span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var">hiAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093179"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093179"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093178"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093178"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093179"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093178"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var">hiAdd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093176"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093176"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093175"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093175"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093176"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; Seq HiValue -&gt; Seq HiValue
forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093175"><span class="hs-identifier hs-var">l2</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="HW5.Impl.html#hiAdd"><span class="hs-identifier hs-var">hiAdd</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | HiFunMul implementation</span><span>
</span><span id="line-95"></span><span id="local-6989586621679093173"><span class="annot"><a href="HW5.Impl.html#hiMul"><span class="hs-identifier hs-type">hiMul</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-96"></span><span id="hiMul"><span class="annot"><span class="annottext">hiMul :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiMul"><span class="hs-identifier hs-var hs-var">hiMul</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093172"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093172"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093171"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093171"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093172"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093171"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="HW5.Impl.html#hiMul"><span class="hs-identifier hs-var">hiMul</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093169"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093169"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679093168"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093168"><span class="hs-identifier hs-var">value</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; Rational -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
HiValue -&gt; Rational -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiStimes"><span class="hs-identifier hs-var">hiStimes</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093168"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093169"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-98"></span><span class="annot"><a href="HW5.Impl.html#hiMul"><span class="hs-identifier hs-var">hiMul</span></a></span><span> </span><span id="local-6989586621679093166"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093166"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093165"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093165"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; Rational -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
HiValue -&gt; Rational -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiStimes"><span class="hs-identifier hs-var">hiStimes</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093166"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093165"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="HW5.Impl.html#hiMul"><span class="hs-identifier hs-var">hiMul</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | HiFunSub implementation</span><span>
</span><span id="line-102"></span><span id="local-6989586621679093164"><span class="annot"><a href="HW5.Impl.html#hiSub"><span class="hs-identifier hs-type">hiSub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093164"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-103"></span><span id="hiSub"><span class="annot"><span class="annottext">hiSub :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiSub"><span class="hs-identifier hs-var hs-var">hiSub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093163"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093163"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093162"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093162"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093163"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093162"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-104"></span><span class="annot"><a href="HW5.Impl.html#hiSub"><span class="hs-identifier hs-var">hiSub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueTime"><span class="hs-identifier hs-type">HiValueTime</span></a></span><span> </span><span id="local-6989586621679093161"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093161"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueTime"><span class="hs-identifier hs-type">HiValueTime</span></a></span><span> </span><span id="local-6989586621679093160"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093160"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Rational) -&gt; NominalDiffTime -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">diffUTCTime</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093161"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679093160"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="HW5.Impl.html#hiSub"><span class="hs-identifier hs-var">hiSub</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | HiFunDiv implementation</span><span>
</span><span id="line-108"></span><span id="local-6989586621679093158"><span class="annot"><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier hs-type">hiDiv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093158"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093158"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-109"></span><span id="hiDiv"><span class="annot"><span class="annottext">hiDiv :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier hs-var hs-var">hiDiv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorDivideByZero"><span class="hs-identifier hs-var">HiErrorDivideByZero</span></a></span><span>
</span><span id="line-110"></span><span class="annot"><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier hs-var">hiDiv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093156"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093156"><span class="hs-identifier hs-var">n1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093155"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093155"><span class="hs-identifier hs-var">n2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093156"><span class="hs-identifier hs-var">n1</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093155"><span class="hs-identifier hs-var">n2</span></a></span><span>
</span><span id="line-111"></span><span class="annot"><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier hs-var">hiDiv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093153"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093153"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093152"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093152"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093153"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
</span><a href="HW5.Impl.html#appendPath"><span class="hs-operator hs-var">`appendPath`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093152"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-112"></span><span class="annot"><a href="HW5.Impl.html#hiDiv"><span class="hs-identifier hs-var">hiDiv</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | HiFunLessThan implementation</span><span>
</span><span id="line-115"></span><span id="local-6989586621679093150"><span class="annot"><a href="HW5.Impl.html#hiLT"><span class="hs-identifier hs-type">hiLT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093150"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093150"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-116"></span><span id="hiLT"><span class="annot"><span class="annottext">hiLT :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiLT"><span class="hs-identifier hs-var hs-var">hiLT</span></a></span></span><span> </span><span id="local-6989586621679093149"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093149"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679093148"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093148"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093149"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093148"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | HiFunNotLessThan implementation</span><span>
</span><span id="line-119"></span><span id="local-6989586621679093145"><span class="annot"><a href="HW5.Impl.html#hiNLT"><span class="hs-identifier hs-type">hiNLT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093145"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093145"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-120"></span><span id="hiNLT"><span class="annot"><span class="annottext">hiNLT :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiNLT"><span class="hs-identifier hs-var hs-var">hiNLT</span></a></span></span><span> </span><span id="local-6989586621679093144"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093144"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679093143"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093143"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093144"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093143"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | HiFunGreaterThan implementation</span><span>
</span><span id="line-123"></span><span id="local-6989586621679093142"><span class="annot"><a href="HW5.Impl.html#hiGT"><span class="hs-identifier hs-type">hiGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093142"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-124"></span><span id="hiGT"><span class="annot"><span class="annottext">hiGT :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiGT"><span class="hs-identifier hs-var hs-var">hiGT</span></a></span></span><span> </span><span id="local-6989586621679093141"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093141"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679093140"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093140"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093141"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093140"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | HiFunNotGreaterThan implementation</span><span>
</span><span id="line-127"></span><span id="local-6989586621679093138"><span class="annot"><a href="HW5.Impl.html#hiNGT"><span class="hs-identifier hs-type">hiNGT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093138"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-128"></span><span id="hiNGT"><span class="annot"><span class="annottext">hiNGT :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiNGT"><span class="hs-identifier hs-var hs-var">hiNGT</span></a></span></span><span> </span><span id="local-6989586621679093137"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093137"><span class="hs-identifier hs-var">v1</span></a></span></span><span> </span><span id="local-6989586621679093136"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093136"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093137"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093136"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | HiFunEquals implementation</span><span>
</span><span id="line-131"></span><span id="local-6989586621679093134"><span class="annot"><a href="HW5.Impl.html#hiEQ"><span class="hs-identifier hs-type">hiEQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-132"></span><span id="hiEQ"><span class="annot"><span class="annottext">hiEQ :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiEQ"><span class="hs-identifier hs-var hs-var">hiEQ</span></a></span></span><span> </span><span id="local-6989586621679093133"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093133"><span class="hs-identifier hs-var">value1</span></a></span></span><span> </span><span id="local-6989586621679093132"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093132"><span class="hs-identifier hs-var">value2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093133"><span class="hs-identifier hs-var">value1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093132"><span class="hs-identifier hs-var">value2</span></a></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | HiFunNotEquals implementation</span><span>
</span><span id="line-135"></span><span id="local-6989586621679093131"><span class="annot"><a href="HW5.Impl.html#hiNEQ"><span class="hs-identifier hs-type">hiNEQ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093131"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093131"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-136"></span><span id="hiNEQ"><span class="annot"><span class="annottext">hiNEQ :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiNEQ"><span class="hs-identifier hs-var hs-var">hiNEQ</span></a></span></span><span> </span><span id="local-6989586621679093130"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093130"><span class="hs-identifier hs-var">value1</span></a></span></span><span> </span><span id="local-6989586621679093129"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093129"><span class="hs-identifier hs-var">value2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093130"><span class="hs-identifier hs-var">value1</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093129"><span class="hs-identifier hs-var">value2</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Monadic analog to foldl1 (like foldlM is to foldl) in the context of the Hi language</span><span>
</span><span id="line-139"></span><span id="local-6989586621679093125"><span id="local-6989586621679093126"><span id="local-6989586621679093127"><span class="annot"><a href="HW5.Impl.html#foldl1M"><span class="hs-identifier hs-type">foldl1M</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679093127"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093126"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679093125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679093125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093125"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679093127"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093125"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093126"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093125"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-140"></span><span id="foldl1M"><span class="annot"><span class="annottext">foldl1M :: (a -&gt; a -&gt; ExceptT HiError m a) -&gt; t a -&gt; ExceptT HiError m a
</span><a href="HW5.Impl.html#foldl1M"><span class="hs-identifier hs-var hs-var">foldl1M</span></a></span></span><span> </span><span id="local-6989586621679093124"><span class="annot"><span class="annottext">a -&gt; a -&gt; ExceptT HiError m a
</span><a href="#local-6989586621679093124"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679093123"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679093123"><span class="hs-identifier hs-var">list</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t a -&gt; [a]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679093123"><span class="hs-identifier hs-var">list</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-141"></span><span>                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m a
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-142"></span><span>                   </span><span class="hs-special">(</span><span id="local-6989586621679093121"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093121"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679093120"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679093120"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; ExceptT HiError m a) -&gt; a -&gt; [a] -&gt; ExceptT HiError m a
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; ExceptT HiError m a
</span><a href="#local-6989586621679093124"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093121"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679093120"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Range implementation</span><span>
</span><span id="line-145"></span><span id="local-6989586621679093118"><span class="annot"><a href="HW5.Impl.html#hiRange"><span class="hs-identifier hs-type">hiRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093118"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-146"></span><span id="hiRange"><span class="annot"><span class="annottext">hiRange :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiRange"><span class="hs-identifier hs-var hs-var">hiRange</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093117"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093117"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093116"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093116"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Seq HiValue
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; Seq HiValue) -&gt; [HiValue] -&gt; Seq HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; [Rational] -&gt; [HiValue]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093117"><span class="hs-identifier hs-var">v1</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093116"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span class="annot"><a href="HW5.Impl.html#hiRange"><span class="hs-identifier hs-var">hiRange</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | implementation of string, list, bytes multiplication with a number</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- if the number isn't Natural throws HiErrorInvalidArgument.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt;&gt;&gt; &quot;hey&quot; * 2</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &quot;heyhey&quot;</span><span>
</span><span id="line-154"></span><span id="local-6989586621679093375"><span class="annot"><a href="HW5.Impl.html#hiStimes"><span class="hs-identifier hs-type">hiStimes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093375"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093375"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-155"></span><span id="hiStimes"><span class="annot"><span class="annottext">hiStimes :: HiValue -&gt; Rational -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiStimes"><span class="hs-identifier hs-var hs-var">hiStimes</span></a></span></span><span> </span><span id="local-6989586621679093114"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093114"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679093113"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-156"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093114"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>                                 </span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093109"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093109"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Text -&gt; Text
forall a b. (Semigroup a, Integral b) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093109"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-158"></span><span>                                 </span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093107"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093107"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Seq HiValue -&gt; Seq HiValue
forall a b. (Semigroup a, Integral b) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093107"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-159"></span><span>                                 </span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093106"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093106"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString -&gt; ByteString
forall a b. (Semigroup a, Integral b) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimes</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093113"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093106"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-160"></span><span>                                 </span><span id="local-6989586621679093105"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093105"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- HiFunWrite implementation</span><span>
</span><span id="line-163"></span><span id="local-6989586621679093104"><span class="annot"><a href="HW5.Impl.html#hiWrite"><span class="hs-identifier hs-type">hiWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093104"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093104"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-164"></span><span id="hiWrite"><span class="annot"><span class="annottext">hiWrite :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiWrite"><span class="hs-identifier hs-var hs-var">hiWrite</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093103"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093103"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093102"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093102"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ByteString -&gt; HiAction
</span><a href="HW5.Base.html#HiActionWrite"><span class="hs-identifier hs-var">HiActionWrite</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093103"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093102"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="annot"><a href="HW5.Impl.html#hiWrite"><span class="hs-identifier hs-var">hiWrite</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- HiFunNot implementation</span><span>
</span><span id="line-168"></span><span id="local-6989586621679093097"><span class="annot"><a href="HW5.Impl.html#hiNot"><span class="hs-identifier hs-type">hiNot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093097"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093097"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-169"></span><span id="hiNot"><span class="annot"><span class="annottext">hiNot :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiNot"><span class="hs-identifier hs-var hs-var">hiNot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-type">HiValueBool</span></a></span><span> </span><span id="local-6989586621679093096"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679093096"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBool"><span class="hs-identifier hs-var">HiValueBool</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; HiValue) -&gt; Bool -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679093096"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-170"></span><span class="annot"><a href="HW5.Impl.html#hiNot"><span class="hs-identifier hs-var">hiNot</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- HiFunReverse implementation</span><span>
</span><span id="line-173"></span><span id="local-6989586621679093095"><span class="annot"><a href="HW5.Impl.html#hiReverse"><span class="hs-identifier hs-type">hiReverse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093095"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-174"></span><span id="hiReverse"><span class="annot"><span class="annottext">hiReverse :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiReverse"><span class="hs-identifier hs-var hs-var">hiReverse</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093094"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">list</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; Seq HiValue
forall a. Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.reverse</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093094"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-175"></span><span class="annot"><a href="HW5.Impl.html#hiReverse"><span class="hs-identifier hs-var">hiReverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093092"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093092"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.reverse</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093092"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-176"></span><span class="annot"><a href="HW5.Impl.html#hiReverse"><span class="hs-identifier hs-var">hiReverse</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- HiFunPackBytes implementation</span><span>
</span><span id="line-179"></span><span id="local-6989586621679093090"><span class="annot"><a href="HW5.Impl.html#hiPackBytes"><span class="hs-identifier hs-type">hiPackBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-180"></span><span id="hiPackBytes"><span class="annot"><span class="annottext">hiPackBytes :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiPackBytes"><span class="hs-identifier hs-var hs-var">hiPackBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093089"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093089"><span class="hs-identifier hs-var">list</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
Monad m =&gt;
[HiValue] -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#packBytes"><span class="hs-identifier hs-var">packBytes</span></a></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; ExceptT HiError m HiValue)
-&gt; [HiValue] -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; [HiValue]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093089"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-181"></span><span class="annot"><a href="HW5.Impl.html#hiPackBytes"><span class="hs-identifier hs-var">hiPackBytes</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- HiFunUnpackBytes implementation</span><span>
</span><span id="line-184"></span><span id="local-6989586621679093087"><span class="annot"><a href="HW5.Impl.html#hiUnpackBytes"><span class="hs-identifier hs-type">hiUnpackBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093087"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-185"></span><span id="hiUnpackBytes"><span class="annot"><span class="annottext">hiUnpackBytes :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiUnpackBytes"><span class="hs-identifier hs-var hs-var">hiUnpackBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093086"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093086"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
Monad m =&gt;
[Word8] -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#unpackBytes"><span class="hs-identifier hs-var">unpackBytes</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; ExceptT HiError m HiValue)
-&gt; [Word8] -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093086"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-186"></span><span class="annot"><a href="HW5.Impl.html#hiUnpackBytes"><span class="hs-identifier hs-var">hiUnpackBytes</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- HiFunEncodeUtf8 implementation</span><span>
</span><span id="line-189"></span><span id="local-6989586621679093083"><span class="annot"><a href="HW5.Impl.html#hiEncodeUtf8"><span class="hs-identifier hs-type">hiEncodeUtf8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093083"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093083"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-190"></span><span id="hiEncodeUtf8"><span class="annot"><span class="annottext">hiEncodeUtf8 :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiEncodeUtf8"><span class="hs-identifier hs-var hs-var">hiEncodeUtf8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093082"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">text</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093082"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-191"></span><span class="annot"><a href="HW5.Impl.html#hiEncodeUtf8"><span class="hs-identifier hs-var">hiEncodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- HiFunDecodeUtf8 implementation</span><span>
</span><span id="line-194"></span><span id="local-6989586621679093081"><span class="annot"><a href="HW5.Impl.html#hiDecodeUtf8"><span class="hs-identifier hs-type">hiDecodeUtf8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093081"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093081"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-195"></span><span id="hiDecodeUtf8"><span class="annot"><span class="annottext">hiDecodeUtf8 :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiDecodeUtf8"><span class="hs-identifier hs-var hs-var">hiDecodeUtf8</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093080"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; Either UnicodeException HiValue -&gt; HiValue
forall b a. b -&gt; Either a b -&gt; b
</span><span class="hs-identifier hs-var">fromRight</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue)
-&gt; Either UnicodeException Text -&gt; Either UnicodeException HiValue
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><span class="hs-identifier hs-var">decodeUtf8'</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093080"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span class="annot"><a href="HW5.Impl.html#hiDecodeUtf8"><span class="hs-identifier hs-var">hiDecodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- HiFunZip implementation</span><span>
</span><span id="line-199"></span><span id="local-6989586621679093075"><span class="annot"><a href="HW5.Impl.html#hiZip"><span class="hs-identifier hs-type">hiZip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093075"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093075"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-200"></span><span id="hiZip"><span class="annot"><span class="annottext">hiZip :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiZip"><span class="hs-identifier hs-var hs-var">hiZip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093074"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093074"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">CompressParams -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">compressWith</span></span><span> </span><span class="annot"><span class="annottext">CompressParams
</span><span class="hs-identifier hs-var">defaultCompressParams</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">compressLevel :: CompressionLevel
</span><span class="hs-identifier hs-var">compressLevel</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CompressionLevel
</span><span class="hs-identifier hs-var">bestCompression</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093074"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span class="annot"><a href="HW5.Impl.html#hiZip"><span class="hs-identifier hs-var">hiZip</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- HiFunUnzip implementation</span><span>
</span><span id="line-205"></span><span id="local-6989586621679093067"><span class="annot"><a href="HW5.Impl.html#hiUnzip"><span class="hs-identifier hs-type">hiUnzip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093067"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093067"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-206"></span><span id="hiUnzip"><span class="annot"><span class="annottext">hiUnzip :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiUnzip"><span class="hs-identifier hs-var hs-var">hiUnzip</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093066"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093066"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><span class="annottext">DecompressParams -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">decompressWith</span></span><span> </span><span class="annot"><span class="annottext">DecompressParams
</span><span class="hs-identifier hs-var">defaultDecompressParams</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093066"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span class="annot"><a href="HW5.Impl.html#hiUnzip"><span class="hs-identifier hs-var">hiUnzip</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- HiFunSerialise implementation</span><span>
</span><span id="line-211"></span><span id="local-6989586621679093062"><span id="local-6989586621679093063"><span class="annot"><a href="HW5.Impl.html#hiSerialise"><span class="hs-identifier hs-type">hiSerialise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093063"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Serialise</span></span><span> </span><span class="annot"><a href="#local-6989586621679093062"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679093062"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093063"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span></span><span>
</span><span id="line-212"></span><span id="hiSerialise"><span class="annot"><span class="annottext">hiSerialise :: a -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiSerialise"><span class="hs-identifier hs-var hs-var">hiSerialise</span></a></span></span><span> </span><span id="local-6989586621679093061"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093061"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.toStrict</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. Serialise a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">serialise</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679093061"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- HiFunDeserialise implementation</span><span>
</span><span id="line-215"></span><span id="local-6989586621679093059"><span class="annot"><a href="HW5.Impl.html#hiDeserialise"><span class="hs-identifier hs-type">hiDeserialise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093059"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-216"></span><span id="hiDeserialise"><span class="annot"><span class="annottext">hiDeserialise :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiDeserialise"><span class="hs-identifier hs-var hs-var">hiDeserialise</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679093058"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093058"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either DeserialiseFailure HiValue
forall a. Serialise a =&gt; ByteString -&gt; Either DeserialiseFailure a
</span><span class="hs-identifier hs-var">deserialiseOrFail</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either DeserialiseFailure HiValue)
-&gt; ByteString -&gt; Either DeserialiseFailure HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">BL.fromStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679093058"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679093056"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093056"><span class="hs-identifier hs-var">res</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093056"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679093055"><span class="annot"><span class="annottext">DeserialiseFailure
</span><a href="#local-6989586621679093055"><span class="hs-identifier hs-var">_deserialFail</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-219"></span><span class="annot"><a href="HW5.Impl.html#hiDeserialise"><span class="hs-identifier hs-var">hiDeserialise</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- HiFunRead implementation</span><span>
</span><span id="line-222"></span><span id="local-6989586621679093054"><span class="annot"><a href="HW5.Impl.html#hiRead"><span class="hs-identifier hs-type">hiRead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093054"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093054"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-223"></span><span id="hiRead"><span class="annot"><span class="annottext">hiRead :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiRead"><span class="hs-identifier hs-var hs-var">hiRead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093053"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093053"><span class="hs-identifier hs-var">filePath</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; HiAction
</span><a href="HW5.Base.html#HiActionRead"><span class="hs-identifier hs-var">HiActionRead</span></a></span><span>  </span><span class="annot"><span class="annottext">(FilePath -&gt; HiAction) -&gt; FilePath -&gt; HiAction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093053"><span class="hs-identifier hs-var">filePath</span></a></span><span>
</span><span id="line-224"></span><span class="annot"><a href="HW5.Impl.html#hiRead"><span class="hs-identifier hs-var">hiRead</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-225"></span><span>                        </span><span>
</span><span id="line-226"></span><span class="hs-comment">-- HiFunMkDir implementation</span><span>
</span><span id="line-227"></span><span id="local-6989586621679093051"><span class="annot"><a href="HW5.Impl.html#hiMkdir"><span class="hs-identifier hs-type">hiMkdir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093051"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-228"></span><span id="hiMkdir"><span class="annot"><span class="annottext">hiMkdir :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiMkdir"><span class="hs-identifier hs-var hs-var">hiMkdir</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093050"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093050"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; HiAction
</span><a href="HW5.Base.html#HiActionMkDir"><span class="hs-identifier hs-var">HiActionMkDir</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; HiAction) -&gt; FilePath -&gt; HiAction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093050"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-229"></span><span class="annot"><a href="HW5.Impl.html#hiMkdir"><span class="hs-identifier hs-var">hiMkdir</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- HiFunChDir implementation</span><span>
</span><span id="line-232"></span><span id="local-6989586621679093048"><span class="annot"><a href="HW5.Impl.html#hiCd"><span class="hs-identifier hs-type">hiCd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093048"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093048"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-233"></span><span id="hiCd"><span class="annot"><span class="annottext">hiCd :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiCd"><span class="hs-identifier hs-var hs-var">hiCd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093047"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">dir</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; HiAction
</span><a href="HW5.Base.html#HiActionChDir"><span class="hs-identifier hs-var">HiActionChDir</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; HiAction) -&gt; FilePath -&gt; HiAction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093047"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-234"></span><span class="annot"><a href="HW5.Impl.html#hiCd"><span class="hs-identifier hs-var">hiCd</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- HiFunParseTime implementation</span><span>
</span><span id="line-237"></span><span id="local-6989586621679093045"><span class="annot"><a href="HW5.Impl.html#hiTimeValue"><span class="hs-identifier hs-type">hiTimeValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093045"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093045"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-238"></span><span id="hiTimeValue"><span class="annot"><span class="annottext">hiTimeValue :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiTimeValue"><span class="hs-identifier hs-var hs-var">hiTimeValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093044"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093044"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; (UTCTime -&gt; HiValue) -&gt; Maybe UTCTime -&gt; HiValue
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; HiValue
</span><a href="HW5.Base.html#HiValueTime"><span class="hs-identifier hs-var">HiValueTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Maybe UTCTime
forall a. Read a =&gt; FilePath -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093044"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span class="annot"><a href="HW5.Impl.html#hiTimeValue"><span class="hs-identifier hs-var">hiTimeValue</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- HiFunEcho implementation</span><span>
</span><span id="line-243"></span><span id="local-6989586621679093042"><span class="annot"><a href="HW5.Impl.html#hiEcho"><span class="hs-identifier hs-type">hiEcho</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093042"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093042"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-244"></span><span id="hiEcho"><span class="annot"><span class="annottext">hiEcho :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiEcho"><span class="hs-identifier hs-var hs-var">hiEcho</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093041"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093041"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiAction
</span><a href="HW5.Base.html#HiActionEcho"><span class="hs-identifier hs-var">HiActionEcho</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093041"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-245"></span><span class="annot"><a href="HW5.Impl.html#hiEcho"><span class="hs-identifier hs-var">hiEcho</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- HiFunKeys implementation</span><span>
</span><span id="line-248"></span><span id="local-6989586621679093039"><span class="annot"><a href="HW5.Impl.html#hiKeys"><span class="hs-identifier hs-type">hiKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093039"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093039"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-249"></span><span id="hiKeys"><span class="annot"><span class="annottext">hiKeys :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiKeys"><span class="hs-identifier hs-var hs-var">hiKeys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-type">HiValueDict</span></a></span><span> </span><span id="local-6989586621679093037"><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093037"><span class="hs-identifier hs-var">dict</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Seq HiValue
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; Seq HiValue) -&gt; [HiValue] -&gt; Seq HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; [HiValue]
forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093037"><span class="hs-identifier hs-var">dict</span></a></span><span>
</span><span id="line-250"></span><span class="annot"><a href="HW5.Impl.html#hiKeys"><span class="hs-identifier hs-var">hiKeys</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- HiFunValues implementation</span><span>
</span><span id="line-253"></span><span id="local-6989586621679093035"><span class="annot"><a href="HW5.Impl.html#hiValues"><span class="hs-identifier hs-type">hiValues</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093035"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093035"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-254"></span><span id="hiValues"><span class="annot"><span class="annottext">hiValues :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiValues"><span class="hs-identifier hs-var hs-var">hiValues</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-type">HiValueDict</span></a></span><span> </span><span id="local-6989586621679093034"><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093034"><span class="hs-identifier hs-var">dict</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Seq HiValue
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; Seq HiValue) -&gt; [HiValue] -&gt; Seq HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; [HiValue]
forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093034"><span class="hs-identifier hs-var">dict</span></a></span><span> </span><span>
</span><span id="line-255"></span><span class="annot"><a href="HW5.Impl.html#hiValues"><span class="hs-identifier hs-var">hiValues</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- HiFunInvert implementation</span><span>
</span><span id="line-258"></span><span id="local-6989586621679093032"><span class="annot"><a href="HW5.Impl.html#hiInvert"><span class="hs-identifier hs-type">hiInvert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093032"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-259"></span><span id="hiInvert"><span class="annot"><span class="annottext">hiInvert :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiInvert"><span class="hs-identifier hs-var hs-var">hiInvert</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-type">HiValueDict</span></a></span><span> </span><span id="local-6989586621679093031"><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093031"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-var">HiValueDict</span></a></span><span> </span><span class="annot"><span class="annottext">(Map HiValue HiValue -&gt; HiValue) -&gt; Map HiValue HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; HiValue)
-&gt; Map HiValue [HiValue] -&gt; Map HiValue HiValue
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue)
-&gt; ([HiValue] -&gt; Seq HiValue) -&gt; [HiValue] -&gt; HiValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Seq HiValue
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([HiValue] -&gt; [HiValue] -&gt; [HiValue])
-&gt; [(HiValue, [HiValue])] -&gt; Map HiValue [HiValue]
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromListWith</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; [HiValue] -&gt; [HiValue]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">[(HiValue, [HiValue])]
</span><a href="#local-6989586621679093027"><span class="hs-identifier hs-var">pairs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679093027"><span class="annot"><span class="annottext">pairs :: [(HiValue, [HiValue])]
</span><a href="#local-6989586621679093027"><span class="hs-identifier hs-var hs-var">pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093026"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093025"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679093025"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093025"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679093026"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093026"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; [(HiValue, HiValue)]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">M.toList</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue
</span><a href="#local-6989586621679093031"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-262"></span><span class="annot"><a href="HW5.Impl.html#hiInvert"><span class="hs-identifier hs-var">hiInvert</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- HiFunToLower implementation</span><span>
</span><span id="line-265"></span><span id="local-6989586621679093023"><span class="annot"><a href="HW5.Impl.html#hiToLower"><span class="hs-identifier hs-type">hiToLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093023"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-266"></span><span id="hiToLower"><span class="annot"><span class="annottext">hiToLower :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiToLower"><span class="hs-identifier hs-var hs-var">hiToLower</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093022"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093022"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toLower</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093022"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-267"></span><span class="annot"><a href="HW5.Impl.html#hiToLower"><span class="hs-identifier hs-var">hiToLower</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- HiFunToUpper implementation</span><span>
</span><span id="line-270"></span><span id="local-6989586621679093020"><span class="annot"><a href="HW5.Impl.html#hiToUpper"><span class="hs-identifier hs-type">hiToUpper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093020"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093020"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-271"></span><span id="hiToUpper"><span class="annot"><span class="annottext">hiToUpper :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiToUpper"><span class="hs-identifier hs-var hs-var">hiToUpper</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093019"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093019"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.toUpper</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093019"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-272"></span><span class="annot"><a href="HW5.Impl.html#hiToUpper"><span class="hs-identifier hs-var">hiToUpper</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- HiFunTrim implementation</span><span>
</span><span id="line-275"></span><span id="local-6989586621679093017"><span class="annot"><a href="HW5.Impl.html#hiTrim"><span class="hs-identifier hs-type">hiTrim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093017"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093017"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-276"></span><span id="hiTrim"><span class="annot"><span class="annottext">hiTrim :: HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiTrim"><span class="hs-identifier hs-var hs-var">hiTrim</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679093016"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093016"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><span class="hs-identifier hs-var">T.strip</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679093016"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-277"></span><span class="annot"><a href="HW5.Impl.html#hiTrim"><span class="hs-identifier hs-var">hiTrim</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- HiFunRand implementation</span><span>
</span><span id="line-280"></span><span id="local-6989586621679093014"><span class="annot"><a href="HW5.Impl.html#hiRandom"><span class="hs-identifier hs-type">hiRandom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679093014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093014"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-281"></span><span id="hiRandom"><span class="annot"><span class="annottext">hiRandom :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiRandom"><span class="hs-identifier hs-var hs-var">hiRandom</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093013"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093012"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093012"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093012"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-282"></span><span>                                                   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093010"><span class="annot"><span class="annottext">conv :: Rational -&gt; Int
</span><a href="#local-6989586621679093010"><span class="hs-identifier hs-var hs-var">conv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; (Rational -&gt; Integer) -&gt; Rational -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span>
</span><span id="line-283"></span><span>                                                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiAction -&gt; HiValue
</span><a href="HW5.Base.html#HiValueAction"><span class="hs-identifier hs-var">HiValueAction</span></a></span><span> </span><span class="annot"><span class="annottext">(HiAction -&gt; HiValue) -&gt; HiAction -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; HiAction
</span><a href="HW5.Base.html#HiActionRand"><span class="hs-identifier hs-var">HiActionRand</span></a></span><span> </span><span>
</span><span id="line-284"></span><span>                                                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Int
</span><a href="#local-6989586621679093010"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093013"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Int
</span><a href="#local-6989586621679093010"><span class="hs-identifier hs-var">conv</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093012"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>                                             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-286"></span><span class="annot"><a href="HW5.Impl.html#hiRandom"><span class="hs-identifier hs-var">hiRandom</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Implementation of slicing on supported containers</span><span>
</span><span id="line-290"></span><span id="local-6989586621679093280"><span class="annot"><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-type">hiSlice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093280"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-291"></span><span id="hiSlice"><span class="annot"><span class="annottext">hiSlice :: HiValue -&gt; HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var hs-var">hiSlice</span></a></span></span><span> </span><span id="local-6989586621679093008"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093008"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093007"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093007"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679093006"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093006"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093007"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093006"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-295"></span><span>      </span><span id="local-6989586621679093005"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093005"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *). HiMonad m =&gt; HiValue -&gt; ExceptT HiError m Int
</span><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093008"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093004"><span class="annot"><span class="annottext">l' :: Int
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp Int
</span><a href="HW5.Impl.html#slicePosInd"><span class="hs-identifier hs-var">slicePosInd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093005"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; (Rational -&gt; Integer) -&gt; Rational -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093007"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679093002"><span class="annot"><span class="annottext">r' :: Int
</span><a href="#local-6989586621679093002"><span class="hs-identifier hs-var hs-var">r'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp Int
</span><a href="HW5.Impl.html#slicePosInd"><span class="hs-identifier hs-var">slicePosInd</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093005"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; (Rational -&gt; Integer) -&gt; Rational -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679093006"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679093008"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-299"></span><span>        </span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679093001"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093001"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq HiValue -&gt; Seq HiValue
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; Seq HiValue) -&gt; Seq HiValue -&gt; Seq HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Seq HiValue -&gt; Seq HiValue
forall a. Int -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">S.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093002"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679093001"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679092998"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092998"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093002"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092998"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679092995"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092995"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093004"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">B.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679093002"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092995"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621679092992"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092992"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-303"></span><span class="annot"><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var">hiSlice</span></a></span><span> </span><span id="local-6989586621679092991"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092991"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679092990"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092990"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
HiValue -&gt; HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var">hiSlice</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092991"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092990"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span class="annot"><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var">hiSlice</span></a></span><span> </span><span id="local-6989586621679092989"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092989"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679092988"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092988"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679092987"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092987"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *). HiMonad m =&gt; HiValue -&gt; ExceptT HiError m Int
</span><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092989"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
HiValue -&gt; HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var">hiSlice</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092989"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092988"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092987"><span class="hs-identifier hs-var">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span class="annot"><a href="HW5.Impl.html#hiSlice"><span class="hs-identifier hs-var">hiSlice</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Indexing implementation on supported containers</span><span>
</span><span id="line-310"></span><span id="local-6989586621679093278"><span class="annot"><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier hs-type">hiIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093278"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093278"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-311"></span><span id="hiIndex"><span class="annot"><span class="annottext">hiIndex :: HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier hs-var hs-var">hiIndex</span></a></span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span id="local-6989586621679092986"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092986"><span class="hs-identifier hs-var">value</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *).
HiMonad m =&gt;
HiValue -&gt; HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier hs-var">hiIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092986"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-312"></span><span class="annot"><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier hs-var">hiIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679092985"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092985"><span class="hs-identifier hs-var">num</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679092984"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092984"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var">isIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092985"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092983"><span class="annot"><span class="annottext">ind :: Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var hs-var">ind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; Integer -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092985"><span class="hs-identifier hs-var">num</span></a></span><span>
</span><span id="line-315"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span> </span><span>
</span><span id="line-316"></span><span>                                </span><span id="local-6989586621679092982"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092982"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *). HiMonad m =&gt; HiValue -&gt; ExceptT HiError m Int
</span><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092984"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-317"></span><span>                                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092982"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span>
</span><span id="line-318"></span><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span>
</span><span id="line-319"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092984"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>                                       </span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679092981"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092981"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; Text -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; Char
</span><span class="hs-identifier hs-var">T.index</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092981"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var">ind</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>                                       </span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679092978"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092978"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Rational -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Rational) -&gt; Word8 -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int -&gt; Word8
</span><span class="hs-identifier hs-var">B.index</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092978"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var">ind</span></a></span><span>
</span><span id="line-322"></span><span>                                       </span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679092976"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092976"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; Maybe HiValue -&gt; HiValue
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><a href="HW5.Base.html#HiValueNull"><span class="hs-identifier hs-var">HiValueNull</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Seq HiValue -&gt; Maybe HiValue
forall a. Int -&gt; Seq a -&gt; Maybe a
</span><span class="hs-identifier hs-var">S.lookup</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092983"><span class="hs-identifier hs-var">ind</span></a></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092976"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>                                       </span><span id="local-6989586621679092973"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092973"><span class="hs-identifier hs-var">_otherwise</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-324"></span><span class="annot"><a href="HW5.Impl.html#hiIndex"><span class="hs-identifier hs-var">hiIndex</span></a></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">HiValue
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">{- Helper functions for implementation -}</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Helper for implentation of pythonic slicing</span><span>
</span><span id="line-329"></span><span class="annot"><a href="HW5.Impl.html#slicePosInd"><span class="hs-identifier hs-type">slicePosInd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-330"></span><span id="slicePosInd"><span class="annot"><span class="annottext">slicePosInd :: BinOp Int
</span><a href="HW5.Impl.html#slicePosInd"><span class="hs-identifier hs-var hs-var">slicePosInd</span></a></span></span><span> </span><span id="local-6989586621679092972"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092972"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679092971"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092971"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092971"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092971"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">BinOp Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092972"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-331"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679092971"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="hs-comment">-- | Length of container but returns int</span><span>
</span><span id="line-335"></span><span id="local-6989586621679093401"><span class="annot"><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-type">getLength</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093401"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093401"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-336"></span><span id="getLength"><span class="annot"><span class="annottext">getLength :: HiValue -&gt; ExceptT HiError m Int
</span><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var hs-var">getLength</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-type">HiValueBytes</span></a></span><span> </span><span id="local-6989586621679092970"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092970"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ExceptT HiError m Int) -&gt; Int -&gt; ExceptT HiError m Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><span class="hs-identifier hs-var">B.length</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092970"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-337"></span><span class="annot"><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-type">HiValueString</span></a></span><span> </span><span id="local-6989586621679092968"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092968"><span class="hs-identifier hs-var">str</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ExceptT HiError m Int) -&gt; Int -&gt; ExceptT HiError m Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092968"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-338"></span><span class="annot"><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-type">HiValueList</span></a></span><span> </span><span id="local-6989586621679092966"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092966"><span class="hs-identifier hs-var">list</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; ExceptT HiError m Int) -&gt; Int -&gt; ExceptT HiError m Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; Int
forall a. Seq a -&gt; Int
</span><span class="hs-identifier hs-var">S.length</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092966"><span class="hs-identifier hs-var">list</span></a></span><span>
</span><span id="line-339"></span><span class="annot"><a href="HW5.Impl.html#getLength"><span class="hs-identifier hs-var">getLength</span></a></span><span> </span><span id="local-6989586621679092964"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092964"><span class="hs-identifier hs-var">_invalid</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m Int
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Implementation of String division</span><span>
</span><span id="line-342"></span><span class="annot"><a href="HW5.Impl.html#appendPath"><span class="hs-identifier hs-type">appendPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-343"></span><span id="appendPath"><span class="annot"><span class="annottext">appendPath :: Text -&gt; Text -&gt; Text
</span><a href="HW5.Impl.html#appendPath"><span class="hs-identifier hs-var hs-var">appendPath</span></a></span></span><span> </span><span id="local-6989586621679092963"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092963"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679092962"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092962"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092963"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Text
</span><span class="hs-identifier hs-var">pack</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092962"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | Checks whether a Rational number is integral</span><span>
</span><span id="line-346"></span><span class="annot"><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-type">isIntegral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-347"></span><span id="isIntegral"><span class="annot"><span class="annottext">isIntegral :: Rational -&gt; Bool
</span><a href="HW5.Impl.html#isIntegral"><span class="hs-identifier hs-var hs-var">isIntegral</span></a></span></span><span> </span><span id="local-6989586621679092961"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092961"><span class="hs-identifier hs-var">num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">denominator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092961"><span class="hs-identifier hs-var">num</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Basically casts a hex number to Word8 </span><span>
</span><span id="line-352"></span><span id="local-6989586621679093264"><span class="annot"><a href="HW5.Impl.html#toWordHex"><span class="hs-identifier hs-type">toWordHex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679093264"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093264"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span></span><span>
</span><span id="line-353"></span><span id="toWordHex"><span class="annot"><span class="annottext">toWordHex :: FilePath -&gt; ExceptT HiError m Word8
</span><a href="HW5.Impl.html#toWordHex"><span class="hs-identifier hs-var hs-var">toWordHex</span></a></span></span><span> </span><span id="local-6989586621679092957"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679092957"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ReadS Integer
forall a. (Eq a, Num a) =&gt; ReadS a
</span><span class="hs-identifier hs-var">readHex</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679092957"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>                  </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679092956"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679092956"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; ExceptT HiError m Word8
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; ExceptT HiError m Word8)
-&gt; Word8 -&gt; ExceptT HiError m Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679092956"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-355"></span><span>                  </span><span id="local-6989586621679092955"><span class="annot"><span class="annottext">[(Integer, FilePath)]
</span><a href="#local-6989586621679092955"><span class="hs-identifier hs-var">_invalid</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m Word8
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-comment">-- | HiFunPackBytes detail Implementation </span><span>
</span><span id="line-358"></span><span id="local-6989586621679093339"><span class="annot"><a href="HW5.Impl.html#packBytes"><span class="hs-identifier hs-type">packBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679093339"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093339"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-359"></span><span id="packBytes"><span class="annot"><span class="annottext">packBytes :: [HiValue] -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#packBytes"><span class="hs-identifier hs-var hs-var">packBytes</span></a></span></span><span> </span><span id="local-6989586621679092954"><span class="annot"><span class="annottext">[HiValue]
</span><a href="#local-6989586621679092954"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679092953"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679092953"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m Word8)
-&gt; [HiValue] -&gt; ExceptT HiError m [Word8]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m Word8
forall (m :: * -&gt; *). Monad m =&gt; HiValue -&gt; ExceptT HiError m Word8
</span><a href="#local-6989586621679092951"><span class="hs-identifier hs-var">mapToHiNum</span></a></span><span> </span><span class="annot"><span class="annottext">[HiValue]
</span><a href="#local-6989586621679092954"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; HiValue
</span><a href="HW5.Base.html#HiValueBytes"><span class="hs-identifier hs-var">HiValueBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; HiValue) -&gt; ByteString -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><span class="hs-identifier hs-var">B.pack</span></span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679092953"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679092951"><span class="annot"><span class="annottext">mapToHiNum :: HiValue -&gt; ExceptT HiError m Word8
</span><a href="#local-6989586621679092951"><span class="hs-identifier hs-var hs-var">mapToHiNum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-type">HiValueNumber</span></a></span><span> </span><span id="local-6989586621679092949"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092949"><span class="hs-identifier hs-var">num</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; ExceptT HiError m Word8
forall (m :: * -&gt; *).
Monad m =&gt;
FilePath -&gt; ExceptT HiError m Word8
</span><a href="HW5.Impl.html#toWordHex"><span class="hs-identifier hs-var">toWordHex</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; ExceptT HiError m Word8)
-&gt; FilePath -&gt; ExceptT HiError m Word8
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ShowS
forall a. (Integral a, Show a) =&gt; a -&gt; ShowS
</span><span class="hs-identifier hs-var">showHex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Integer
forall a. Ratio a -&gt; a
</span><span class="hs-identifier hs-var">numerator</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679092949"><span class="hs-identifier hs-var">num</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><a href="#local-6989586621679092951"><span class="hs-identifier hs-var">mapToHiNum</span></a></span><span> </span><span id="local-6989586621679092948"><span class="annot"><span class="annottext">HiValue
</span><a href="#local-6989586621679092948"><span class="hs-identifier hs-var">_invalid</span></a></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiError -&gt; ExceptT HiError m Word8
forall (m :: * -&gt; *) e a. Monad m =&gt; e -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">throwE</span></span><span> </span><span class="annot"><span class="annottext">HiError
</span><a href="HW5.Base.html#HiErrorInvalidArgument"><span class="hs-identifier hs-var">HiErrorInvalidArgument</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | HiFunUnpackBytes detail implementation</span><span>
</span><span id="line-367"></span><span id="local-6989586621679093337"><span class="annot"><a href="HW5.Impl.html#unpackBytes"><span class="hs-identifier hs-type">unpackBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679093337"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093337"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-368"></span><span id="unpackBytes"><span class="annot"><span class="annottext">unpackBytes :: [Word8] -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#unpackBytes"><span class="hs-identifier hs-var hs-var">unpackBytes</span></a></span></span><span> </span><span id="local-6989586621679092947"><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679092947"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679092946"><span class="annot"><span class="annottext">arr' :: [HiValue]
</span><a href="#local-6989586621679092946"><span class="hs-identifier hs-var hs-var">arr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; HiValue) -&gt; [Word8] -&gt; [HiValue]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; (Word8 -&gt; Rational) -&gt; Word8 -&gt; HiValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Word8]
</span><a href="#local-6989586621679092947"><span class="hs-identifier hs-var">arr</span></a></span><span>
</span><span id="line-369"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueList"><span class="hs-identifier hs-var">HiValueList</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq HiValue -&gt; HiValue) -&gt; Seq HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Seq HiValue
forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">[HiValue]
</span><a href="#local-6989586621679092946"><span class="hs-identifier hs-var">arr'</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Concatinates ByteStrings together</span><span>
</span><span id="line-372"></span><span class="annot"><a href="HW5.Impl.html#concatBytes"><span class="hs-identifier hs-type">concatBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#BinOp"><span class="hs-identifier hs-type">BinOp</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span>
</span><span id="line-373"></span><span id="concatBytes"><span class="annot"><span class="annottext">concatBytes :: BinOp ByteString
</span><a href="HW5.Impl.html#concatBytes"><span class="hs-identifier hs-var hs-var">concatBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BinOp ByteString
</span><span class="hs-identifier hs-var">B.append</span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- | HiFunCount implementation for ByteStrings</span><span>
</span><span id="line-376"></span><span id="local-6989586621679093387"><span class="annot"><a href="HW5.Impl.html#countByteString"><span class="hs-identifier hs-type">countByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">B.ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093387"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-377"></span><span id="countByteString"><span class="annot"><span class="annottext">countByteString :: ByteString -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countByteString"><span class="hs-identifier hs-var hs-var">countByteString</span></a></span></span><span> </span><span id="local-6989586621679092944"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092944"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-var">HiValueDict</span></a></span><span> </span><span class="annot"><span class="annottext">(Map HiValue HiValue -&gt; HiValue) -&gt; Map HiValue HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="annottext">(Word8 -&gt; HiValue) -&gt; Map Word8 HiValue -&gt; Map HiValue HiValue
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; (Word8 -&gt; Rational) -&gt; Word8 -&gt; HiValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><span class="hs-identifier hs-var">toRational</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Word8] -&gt; Map Word8 HiValue
forall a. Ord a =&gt; [a] -&gt; Map a HiValue
</span><a href="HW5.Impl.html#countEls"><span class="hs-identifier hs-var">countEls</span></a></span><span> </span><span class="annot"><span class="annottext">([Word8] -&gt; Map Word8 HiValue) -&gt; [Word8] -&gt; Map Word8 HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [Word8]
</span><span class="hs-identifier hs-var">B.unpack</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679092944"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | HiFunCount implementation for Strings </span><span>
</span><span id="line-381"></span><span id="local-6989586621679093391"><span class="annot"><a href="HW5.Impl.html#countString"><span class="hs-identifier hs-type">countString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093391"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093391"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-382"></span><span id="countString"><span class="annot"><span class="annottext">countString :: Text -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countString"><span class="hs-identifier hs-var hs-var">countString</span></a></span></span><span> </span><span id="local-6989586621679092941"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092941"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-var">HiValueDict</span></a></span><span> </span><span class="annot"><span class="annottext">(Map HiValue HiValue -&gt; HiValue) -&gt; Map HiValue HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">(Char -&gt; HiValue) -&gt; Map Char HiValue -&gt; Map HiValue HiValue
forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">mapKeys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; HiValue
</span><a href="HW5.Base.html#HiValueString"><span class="hs-identifier hs-var">HiValueString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; HiValue) -&gt; (Char -&gt; Text) -&gt; Char -&gt; HiValue
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">T.singleton</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; Map Char HiValue
forall a. Ord a =&gt; [a] -&gt; Map a HiValue
</span><a href="HW5.Impl.html#countEls"><span class="hs-identifier hs-var">countEls</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; Map Char HiValue) -&gt; FilePath -&gt; Map Char HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; FilePath
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679092941"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | HiFunCount implementation for lists</span><span>
</span><span id="line-386"></span><span id="local-6989586621679093389"><span class="annot"><a href="HW5.Impl.html#countList"><span class="hs-identifier hs-type">countList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="HW5.Base.html#HiMonad"><span class="hs-identifier hs-type">HiMonad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093389"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="HW5.Base.html#HiError"><span class="hs-identifier hs-type">HiError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679093389"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-387"></span><span id="countList"><span class="annot"><span class="annottext">countList :: Seq HiValue -&gt; ExceptT HiError m HiValue
</span><a href="HW5.Impl.html#countList"><span class="hs-identifier hs-var hs-var">countList</span></a></span></span><span> </span><span id="local-6989586621679092939"><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092939"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HiValue -&gt; ExceptT HiError m HiValue
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(HiValue -&gt; ExceptT HiError m HiValue)
-&gt; HiValue -&gt; ExceptT HiError m HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map HiValue HiValue -&gt; HiValue
</span><a href="HW5.Base.html#HiValueDict"><span class="hs-identifier hs-var">HiValueDict</span></a></span><span> </span><span class="annot"><span class="annottext">(Map HiValue HiValue -&gt; HiValue) -&gt; Map HiValue HiValue -&gt; HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[HiValue] -&gt; Map HiValue HiValue
forall a. Ord a =&gt; [a] -&gt; Map a HiValue
</span><a href="HW5.Impl.html#countEls"><span class="hs-identifier hs-var">countEls</span></a></span><span> </span><span class="annot"><span class="annottext">([HiValue] -&gt; Map HiValue HiValue)
-&gt; [HiValue] -&gt; Map HiValue HiValue
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue -&gt; [HiValue]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><span class="hs-identifier hs-var">F.toList</span></span><span> </span><span class="annot"><span class="annottext">Seq HiValue
</span><a href="#local-6989586621679092939"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | Helper function for HiFunCount that maps an element to its occurance</span><span>
</span><span id="line-390"></span><span id="local-6989586621679093256"><span class="annot"><a href="HW5.Impl.html#countEls"><span class="hs-identifier hs-type">countEls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679093256"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679093256"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679093256"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="HW5.Base.html#HiValue"><span class="hs-identifier hs-type">HiValue</span></a></span></span><span>
</span><span id="line-391"></span><span id="countEls"><span class="annot"><span class="annottext">countEls :: [a] -&gt; Map a HiValue
</span><a href="HW5.Impl.html#countEls"><span class="hs-identifier hs-var hs-var">countEls</span></a></span></span><span> </span><span id="local-6989586621679092938"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679092938"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; HiValue) -&gt; Map a Rational -&gt; Map a HiValue
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; HiValue
</span><a href="HW5.Base.html#HiValueNumber"><span class="hs-identifier hs-var">HiValueNumber</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rational -&gt; Rational -&gt; Rational)
-&gt; [(a, Rational)] -&gt; Map a Rational
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">fromListWith</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span> </span><span class="annot"><span class="annottext">[(a, Rational)]
</span><a href="#local-6989586621679092937"><span class="hs-identifier hs-var">freq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-393"></span><span>    </span><span id="local-6989586621679092937"><span class="annot"><span class="annottext">freq :: [(a, Rational)]
</span><a href="#local-6989586621679092937"><span class="hs-identifier hs-var hs-var">freq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679092936"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679092936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679092936"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679092938"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span></pre></body></html>