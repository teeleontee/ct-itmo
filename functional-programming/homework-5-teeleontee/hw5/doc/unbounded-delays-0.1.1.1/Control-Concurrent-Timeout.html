<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Control.Concurrent.Timeout</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">unbounded-delays-0.1.1.1: Unbounded thread delays and timeouts</span><ul class="links" id="page-menu"><li><a href="src/Control.Concurrent.Timeout.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Control.Concurrent.Timeout</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Wait arbitrarily long for an IO computation to finish.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:timeout">timeout</a> :: <a href="../base-4.14.3.0/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> &#945; -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> &#945;)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Timeout">Timeout</a></li><li class="src short"><a href="#v:timeoutWithPred">timeoutWithPred</a> :: <a href="../base-4.14.3.0/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; ((<a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> &#945;) -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> &#945;)</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:timeout" class="def">timeout</a> :: <a href="../base-4.14.3.0/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> &#945; -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> &#945;) <a href="src/Control.Concurrent.Timeout.html#timeout" class="link">Source</a> <a href="#v:timeout" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Control-Concurrent-Timeout.html#v:timeoutWithPred" title="Control.Concurrent.Timeout">timeoutWithPred</a></code>, but does not expose the <code><a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a></code> exception to the called action.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Timeout" class="def">Timeout</a> <a href="src/Control.Concurrent.Timeout.html#Timeout" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></p><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Timeout">Instances</h4><details id="i:Timeout" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Eq:1"></span> <a href="../base-4.14.3.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a></span> <a href="src/Control.Concurrent.Timeout.html#line-56" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Timeout:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Control-Concurrent-Timeout.html">Control.Concurrent.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Show:2"></span> <a href="../base-4.14.3.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a></span> <a href="src/Control.Concurrent.Timeout.html#line-58" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Timeout:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Control-Concurrent-Timeout.html">Control.Concurrent.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a>] -&gt; <a href="../base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Timeout:Exception:3"></span> <a href="../base-4.14.3.0/Control-Exception-Base.html#t:Exception" title="Control.Exception.Base">Exception</a> <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a></span> <a href="src/Control.Concurrent.Timeout.html#line-61" class="link">Source</a> <a href="#t:Timeout" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Timeout:Exception:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Control-Concurrent-Timeout.html">Control.Concurrent.Timeout</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toException">toException</a> :: <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> <a href="#v:toException" class="selflink">#</a></p><p class="src"><a href="#v:fromException">fromException</a> :: <a href="../base-4.14.3.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> <a href="#v:fromException" class="selflink">#</a></p><p class="src"><a href="#v:displayException">displayException</a> :: <a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="#v:displayException" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:timeoutWithPred" class="def">timeoutWithPred</a> :: <a href="../base-4.14.3.0/Prelude.html#t:Integer" title="Prelude">Integer</a> -&gt; ((<a href="Control-Concurrent-Timeout.html#t:Timeout" title="Control.Concurrent.Timeout">Timeout</a> -&gt; <a href="../base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a>) -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> &#945;) -&gt; <a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.14.3.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> &#945;) <a href="src/Control.Concurrent.Timeout.html#timeoutWithPred" class="link">Source</a> <a href="#v:timeoutWithPred" class="selflink">#</a></p><div class="doc"><p>Like <code>System.Timeout.<code><a href="../base-4.14.3.0/System-Timeout.html#v:timeout" title="System.Timeout">timeout</a></code></code>, but not bounded by an <code><a href="../base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></code>.
(..)
Wrap an <code><a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a></code> computation to time out and return <code><a href="../base-4.14.3.0/Data-Maybe.html#v:Nothing" title="Data.Maybe">Nothing</a></code> in case no result is
available within <code>n</code> microseconds (<code>1/10^6</code> seconds). In case a result is
available before the timeout expires, <code><a href="../base-4.14.3.0/Data-Maybe.html#v:Just" title="Data.Maybe">Just</a></code> <code>a</code> is returned. A negative timeout
interval means &quot;wait indefinitely&quot;.</p><p>If the computation has not terminated after <code>n</code> microseconds, it is interrupted
by an asynchronous exception. The function passed to <code>f</code> can be used to detect
whether it was interrupted by this timeout or some other exception.</p><p>The design of this combinator was guided by the objective that <code>timeout n (const f)</code>
should behave exactly the same as <code>f</code> as long as <code>f</code> doesn't time out. This
means that <code>f</code> has the same <code><a href="../base-4.14.3.0/Control-Concurrent.html#v:myThreadId" title="Control.Concurrent">myThreadId</a></code> it would have without the timeout
wrapper. Any exceptions <code>f</code> might throw cancel the timeout and propagate further
up. It also possible for <code>f</code> to receive exceptions thrown to it by another
thread.</p><p>A tricky implementation detail is the question of how to abort an <code><a href="../base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a></code>
computation. This combinator relies on asynchronous exceptions internally.  The
technique works very well for computations executing inside of the Haskell
runtime system, but it doesn't work at all for non-Haskell code. Foreign
function calls, for example, cannot be timed out with this combinator simply
because an arbitrary C function cannot receive asynchronous exceptions. When
<code>timeout</code> is used to wrap an FFI call that blocks, no timeout event can be
delivered until the FFI call returns, which pretty much negates the purpose of
the combinator. In practice, however, this limitation is less severe than it may
sound. Standard I/O functions like <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#v:hGetBuf" title="GHC.IO.Handle">hGetBuf</a></code>, <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#v:hPutBuf" title="GHC.IO.Handle">hPutBuf</a></code>,
Network.Socket.accept, or <code><a href="../base-4.14.3.0/GHC-IO-Handle.html#v:hWaitForInput" title="GHC.IO.Handle">hWaitForInput</a></code> appear to be blocking, but
they really don't because the runtime system uses scheduling mechanisms like
<code>select(2)</code> to perform asynchronous I/O, so it is possible to interrupt
standard socket I/O or file I/O using this combinator.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>