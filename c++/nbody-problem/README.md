# Задача

Рассмотрим упрощенную модель вселенной, состоящую из N тел, расположенных в двумерной плоскости. Для каждого тела известна его масса, начальное положение и начальная скорость. На каждое тело действует гравитационная сила других тел. Необходимо найти траекторию движения всех N тел в течение времени T.

Рассмотрим приближенное решение задачи. Разобьём отрезок времени T на K равных интервалов delta_T и положим, что ускорение каждого тела постоянно в интервале времени delta_T. Чем большее число K разбиений интервала T и чем меньше интервал времени delta_T, тем точнее будет решение задачи.

# Алгоритм Барнса-Хата.

Казалось бы для решении этой задачи надо рассчитать силы между всеми телами, так можно делать, но это будет работать за O(n^2), для ускорения вычислений можно заменить точное вычисление гравитационной силы F, действующей на тело B, приближенным её вычислением. Для этого найдём и сгруппируем все достаточно близко расположенные тела. Будем рассматривать группу тел как одно тело,  расположенное в центре масс этой группы тел. Масса этого тела равна сумме масс всех тел, входящих в группу.

Для того, чтобы сгруппировать близлежащие тела, будем использовать 4-е дерево специального вида. Каждая вершина этого дерева будет соответствовать некоторой области двумерной плоскости. Корень дерева будет соответствовать всей плоскости, а его потомки -- четерём квадрантам плоскости. В свою очередь, каждый квадрант делиться на четыре квадратна, соответствующие вершинам 2го уровня. Каждый лист этого дерева будет содержать одно тело, а каждая не листовая вершина соответствовать некоторой области плоскости, содержащую группу тел. Каждая не листовая вершина будет хранить массу группы тел и координаты центра масс этой группы.

Пример для 8ми тел на плоскости

![](https://introcs.cs.princeton.edu/java/assignments/example.gif)

Для того, чтобы вычислить гравитационную силу, действующую на конкретное тело B, необходимо совершить обход дерева начиная с корня. Если центр масса текущей вершины дерева находится достаточно далеко от тела B, то вычисляется гравитационная сила относительно этого центра масс. Иначе необходимо вычислить гравитационную силу относительно всех дочерних вершин данной вершины. 

### Входные данные

Файл с таблицей начальных положений тел, начальной скорость движения, массой и названием тела: 
```
// Size of universe
2.50e+12
// X_0 Y_0 V_x V_y M Name
1.4960e+11  0.0000e+00  0.0000e+00  2.9800e+04  5.9740e+24 Earth
2.2790e+11  0.0000e+00  0.0000e+00  2.4100e+04  6.4190e+23 Mars
5.7900e+10  0.0000e+00  0.0000e+00  4.7900e+04  3.3020e+23 Mercury
0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00  1.9890e+30 Sun
1.0820e+11  0.0000e+00  0.0000e+00  3.5000e+04  4.8690e+24 Venus
```
и два параметра: время T и точность вычисления K.

### Результат работы программы
Таблица конечных положений тел:
```
Earth   X_0  Y_0
Mars    X_1  Y_1
Mercury X_2  Y_2
Sun     X_3  Y_3
Venus   X_4  Y_4
```
